/**
 * üéØ EXERCICES PRATIQUES ATELIER 1 - SOCLE DE S√âCURIT√â
 * Exercices sp√©cialis√©s pour ma√Ætriser le cadrage et l'identification des biens essentiels CHU
 */

// üéØ TYPES POUR LES EXERCICES ATELIER 1
export interface SecurityFoundationExercise {
  id: string;
  title: string;
  description: string;
  type: 'scoping_analysis' | 'asset_identification' | 'ecosystem_mapping' | 'security_objectives' | 'governance_simulation';
  difficulty: 'intermediate' | 'advanced' | 'expert';
  duration: number; // minutes
  points: number;
  category: string;
  scenario: ExerciseScenario;
  questions: ExerciseQuestion[];
  context: CHUContext;
  learningObjectives: string[];
  realWorldExample: string;
  anssiCompliance: string[];
}

export interface ExerciseScenario {
  id: string;
  title: string;
  description: string;
  context: string;
  constraints: string[];
  stakeholders: string[];
  expectedOutcome: string;
}

export interface ExerciseQuestion {
  id: string;
  question: string;
  type: 'multiple_choice' | 'multiple_select' | 'ranking' | 'classification' | 'scenario_analysis' | 'matrix_analysis';
  options?: string[];
  correctAnswer: any;
  explanation: string;
  points: number;
  hints?: string[];
  commonMistakes?: string[];
  expertTips?: string[];
}

export interface CHUContext {
  hospitalType: string;
  bedCount: number;
  sites: number;
  employees: number;
  budget: string;
  specialties: string[];
  itInfrastructure: ITInfrastructure;
  regulatoryRequirements: string[];
  operationalConstraints: OperationalConstraint[];
  partners: PartnerInfo[];
}

export interface ITInfrastructure {
  systems: SystemInfo[];
  networks: NetworkInfo[];
  servers: ServerInfo;
  applications: ApplicationInfo[];
}

export interface SystemInfo {
  name: string;
  type: string;
  criticality: 'CRITIQUE' | 'MAJEUR' | 'MOD√âR√â' | 'MINEUR';
  users: number;
  availability: string;
}

export interface NetworkInfo {
  name: string;
  type: string;
  coverage: string;
  security: string;
}

export interface ServerInfo {
  physical: number;
  virtual: number;
  locations: string[];
}

export interface ApplicationInfo {
  name: string;
  type: string;
  criticality: 'CRITIQUE' | 'MAJEUR' | 'MOD√âR√â' | 'MINEUR';
  users: number;
}

export interface OperationalConstraint {
  type: string;
  description: string;
  impact: string;
  mitigation: string;
}

export interface PartnerInfo {
  name: string;
  type: string;
  criticality: string;
  services: string[];
}

/**
 * üéØ CLASSE PRINCIPALE DES EXERCICES ATELIER 1
 */
export class SecurityFoundationExercises {
  
  // ü•á EXERCICE 1 - CADRAGE ET P√âRIM√àTRE CHU (25 MIN, 80 PTS)
  static getExercise1_ScopingAnalysis(): SecurityFoundationExercise {
    return {
      id: 'exercise_1_scoping_chu',
      title: 'Cadrage et P√©rim√®tre CHU',
      description: 'Ma√Ætriser la d√©finition du p√©rim√®tre d\'analyse EBIOS RM pour un CHU',
      type: 'scoping_analysis',
      difficulty: 'intermediate',
      duration: 25,
      points: 80,
      category: 'Cadrage m√©thodologique',
      scenario: {
        id: 'chu_metropolitan_scoping',
        title: 'CHU M√©tropolitain - D√©finition p√©rim√®tre EBIOS RM',
        description: 'Vous √™tes consultant EBIOS RM mandat√© pour analyser la s√©curit√© du CHU M√©tropolitain',
        context: `Le CHU M√©tropolitain est un √©tablissement de 1200 lits r√©partis sur 3 sites :
        - Site Principal (800 lits) : Urgences, R√©animation, Blocs op√©ratoires
        - Site Sp√©cialis√© (250 lits) : Cardiologie, Neurochirurgie, Oncologie  
        - Centre Ambulatoire (150 lits) : Consultations, H√¥pital de jour`,
        constraints: [
          'Continuit√© des soins 24h/24 non n√©gociable',
          'Budget limit√© : 2M‚Ç¨ sur 3 ans pour la s√©curit√©',
          'Personnel m√©dical r√©ticent aux changements',
          'Conformit√© HDS et RGPD obligatoire'
        ],
        stakeholders: [
          'Directeur G√©n√©ral', 'Directeur M√©dical', 'RSSI', 'DSI',
          'Chefs de p√¥le', 'Directeur des Soins', 'Directeur Qualit√©'
        ],
        expectedOutcome: 'P√©rim√®tre d\'analyse valid√© par le COMEX et conforme ANSSI'
      },
      questions: [
        {
          id: 'q1_organizational_scope',
          question: 'D√©finissez le p√©rim√®tre organisationnel optimal pour cette analyse EBIOS RM :',
          type: 'multiple_select',
          options: [
            '3 sites g√©ographiques du CHU uniquement',
            '3 sites + 25 √©tablissements partenaires r√©gionaux',
            '3 sites + laboratoires externes critiques',
            '3 sites + prestataires maintenance critiques',
            'Site principal uniquement (focus urgences)',
            '3 sites + organismes tutelle (ARS, CPAM)'
          ],
          correctAnswer: ['3 sites g√©ographiques du CHU uniquement', '3 sites + laboratoires externes critiques', '3 sites + prestataires maintenance critiques'],
          explanation: `**P√©rim√®tre organisationnel optimal :**
          
‚úÖ **Inclure obligatoirement :**
- 3 sites CHU (p√©rim√®tre principal)
- Laboratoires externes critiques (analyses urgentes)
- Prestataires maintenance critiques (√©quipements vitaux)

‚ùå **Exclure de cette premi√®re analyse :**
- 25 partenaires r√©gionaux (trop large, analyse s√©par√©e)
- Organismes tutelle (hors p√©rim√®tre direct)
- Site principal seul (p√©rim√®tre trop restreint)

**Justification ANSSI :** Le p√©rim√®tre doit √™tre coh√©rent avec les enjeux m√©tier et les capacit√©s d'analyse.`,
          points: 20,
          hints: ['Pensez aux d√©pendances critiques directes', '√âvitez un p√©rim√®tre trop large pour une premi√®re analyse'],
          commonMistakes: ['Inclure tous les partenaires (p√©rim√®tre ing√©rable)', 'Exclure les laboratoires externes (d√©pendance critique)'],
          expertTips: ['Commencez par le p√©rim√®tre direct, √©tendez ensuite', 'Validez avec les m√©tiers la faisabilit√©']
        },
        {
          id: 'q2_business_stakes',
          question: 'Classez ces 8 enjeux m√©tier par ordre de priorit√© pour le CHU (1=plus prioritaire) :',
          type: 'ranking',
          options: [
            'Continuit√© des soins 24h/24',
            'Conformit√© r√©glementaire (HDS, RGPD)',
            'S√©curit√© des patients et du personnel',
            '√âquilibre financier et ma√Ætrise des co√ªts',
            'Qualit√© et tra√ßabilit√© des soins',
            'R√©putation et attractivit√© territoriale',
            'Innovation et recherche m√©dicale',
            'Partenariats et coop√©rations'
          ],
          correctAnswer: [
            'Continuit√© des soins 24h/24',
            'S√©curit√© des patients et du personnel', 
            'Conformit√© r√©glementaire (HDS, RGPD)',
            'Qualit√© et tra√ßabilit√© des soins',
            '√âquilibre financier et ma√Ætrise des co√ªts',
            'R√©putation et attractivit√© territoriale',
            'Innovation et recherche m√©dicale',
            'Partenariats et coop√©rations'
          ],
          explanation: `**Priorisation justifi√©e secteur sant√© :**

ü•á **Priorit√© 1-2 : Enjeux vitaux**
- Continuit√© soins (vies en jeu)
- S√©curit√© patients (responsabilit√© p√©nale)

ü•à **Priorit√© 3-4 : Enjeux r√©glementaires**  
- Conformit√© (sanctions, fermeture)
- Qualit√© soins (certification HAS)

ü•â **Priorit√© 5-8 : Enjeux strat√©giques**
- √âquilibre financier, r√©putation, innovation, partenariats`,
          points: 25,
          expertTips: ['Les vies humaines priment toujours en sant√©', 'La conformit√© r√©glementaire est non n√©gociable']
        }
      ],
      context: {
        hospitalType: 'CHU M√©tropolitain',
        bedCount: 1200,
        sites: 3,
        employees: 3500,
        budget: '450M‚Ç¨/an',
        specialties: ['Urgences', 'R√©animation', 'Cardiologie', 'Neurochirurgie', 'Oncologie', 'P√©diatrie'],
        itInfrastructure: {
          systems: [
            { name: 'SIH Principal', type: 'ERP Sant√©', criticality: 'CRITIQUE', users: 3000, availability: '99.9%' },
            { name: 'PACS Imagerie', type: 'Imagerie m√©dicale', criticality: 'CRITIQUE', users: 500, availability: '99.8%' }
          ],
          networks: [
            { name: 'R√©seau m√©dical', type: 'VLAN s√©curis√©', coverage: '3 sites', security: 'WPA3 Enterprise' },
            { name: 'R√©seau administratif', type: 'VLAN standard', coverage: '3 sites', security: 'WPA2' }
          ],
          servers: { physical: 200, virtual: 800, locations: ['Site Principal', 'Site Sp√©cialis√©', 'Cloud HDS'] },
          applications: [
            { name: 'Dossier Patient Informatis√©', type: 'M√©tier critique', criticality: 'CRITIQUE', users: 2800 },
            { name: 'Gestion Administrative', type: 'Support', criticality: 'MAJEUR', users: 700 }
          ]
        },
        regulatoryRequirements: ['HDS', 'RGPD', 'HAS', 'ANSSI', 'Code de la sant√© publique'],
        operationalConstraints: [
          { type: 'Continuit√©', description: 'Soins 24h/24', impact: 'Vies en jeu', mitigation: 'Redondance totale' },
          { type: 'R√©glementaire', description: 'Conformit√© HDS', impact: 'Fermeture', mitigation: 'Audit permanent' }
        ],
        partners: [
          { name: 'Laboratoires Externes', type: 'Prestataire critique', criticality: 'CRITIQUE', services: ['Analyses urgentes'] },
          { name: 'Maintenance Biom√©dicale', type: 'Prestataire', criticality: 'MAJEUR', services: ['√âquipements vitaux'] }
        ]
      },
      learningObjectives: [
        'D√©finir un p√©rim√®tre d\'analyse coh√©rent et r√©aliste',
        'Prioriser les enjeux m√©tier selon les sp√©cificit√©s sant√©',
        'Identifier les contraintes r√©glementaires applicables',
        'Structurer les objectifs de s√©curit√© par domaine'
      ],
      realWorldExample: 'Analyse EBIOS RM du CHU de Rouen post-cyberattaque (2019)',
      anssiCompliance: ['Guide EBIOS RM v1.5 - √âtape 1', 'R√©f√©rentiel s√©curit√© ANSSI secteur sant√©']
    };
  }

  // ü•à EXERCICE 2 - IDENTIFICATION BIENS ESSENTIELS (30 MIN, 120 PTS)
  static getExercise2_AssetIdentification(): SecurityFoundationExercise {
    return {
      id: 'exercise_2_asset_identification',
      title: 'Identification des Biens Essentiels',
      description: 'Ma√Ætriser la m√©thodologie d\'identification et classification des biens essentiels CHU',
      type: 'asset_identification',
      difficulty: 'advanced',
      duration: 30,
      points: 120,
      category: 'Analyse des biens essentiels',
      scenario: {
        id: 'chu_asset_inventory',
        title: 'Inventaire exhaustif des biens essentiels CHU avec matrice BIA',
        description: 'Appliquer la m√©thodologie ANSSI d\'identification des biens essentiels au contexte CHU',
        context: `Mission : Identifier et classifier tous les biens essentiels du CHU selon la grille BIA adapt√©e sant√©.
        Contrainte : Validation obligatoire par le comit√© multidisciplinaire (7 membres).`,
        constraints: [
          'M√©thodologie ANSSI EBIOS RM strictement respect√©e',
          'Grille BIA adapt√©e aux sp√©cificit√©s secteur sant√©',
          'Classification justifi√©e avec impacts m√©tier',
          'Validation par comit√© multidisciplinaire obligatoire'
        ],
        stakeholders: [
          'Chef p√¥le Urgences', 'Directeur Soins', 'RSSI', 'DSI',
          'Pharmacien Chef', 'Chef Laboratoires', 'Directeur Qualit√©'
        ],
        expectedOutcome: 'Inventaire complet valid√© avec matrice de criticit√©'
      },
      questions: [
        {
          id: 'q1_asset_inventory',
          question: 'Identifiez et classifiez ces 15 biens essentiels par cat√©gorie ANSSI :',
          type: 'classification',
          options: [
            'Urgences vitales 24h/24',
            'Dossiers patients informatis√©s',
            'SIH - Syst√®me Information Hospitalier',
            'Images m√©dicales PACS',
            'Bloc op√©ratoire programm√©',
            'Laboratoires d\'analyses',
            'Centre de donn√©es principal',
            'R√©seaux et t√©l√©communications',
            'Pharmacie hospitali√®re',
            'Recherche clinique',
            'Gestion administrative',
            'Alimentations √©lectriques',
            'Personnel m√©dical sp√©cialis√©',
            '√âquipements biom√©dicaux',
            'Partenaires laboratoires externes'
          ],
          correctAnswer: {
            'Processus m√©tier': ['Urgences vitales 24h/24', 'Bloc op√©ratoire programm√©', 'Laboratoires d\'analyses', 'Pharmacie hospitali√®re', 'Recherche clinique', 'Gestion administrative'],
            'Informations': ['Dossiers patients informatis√©s', 'Images m√©dicales PACS'],
            'Syst√®mes d\'information': ['SIH - Syst√®me Information Hospitalier', 'R√©seaux et t√©l√©communications'],
            'Infrastructures': ['Centre de donn√©es principal', 'Alimentations √©lectriques', '√âquipements biom√©dicaux'],
            'Ressources humaines': ['Personnel m√©dical sp√©cialis√©'],
            'Partenaires': ['Partenaires laboratoires externes']
          },
          explanation: `**Classification ANSSI adapt√©e sant√© :**

üìã **Processus m√©tier** : Activit√©s op√©rationnelles hospitali√®res
üìä **Informations** : Donn√©es critiques patients et m√©dicales
üíª **Syst√®mes d'information** : Applications et r√©seaux
üèóÔ∏è **Infrastructures** : √âquipements et installations techniques
üë• **Ressources humaines** : Personnel cl√© sp√©cialis√©
ü§ù **Partenaires** : Tiers critiques pour l'activit√©`,
          points: 40,
          hints: ['Suivez la classification ANSSI standard', 'Adaptez au contexte hospitalier'],
          expertTips: ['Les processus m√©tier sont les activit√©s op√©rationnelles', 'Les informations sont les donn√©es manipul√©es']
        },
        {
          id: 'q2_criticality_matrix',
          question: 'Appliquez la grille BIA sp√©cialis√©e sant√© √† ces 8 biens essentiels :',
          type: 'matrix_analysis',
          options: [
            'Urgences vitales (Impact soins: 5, Impact financier: 4, Impact r√©glementaire: 4)',
            'SIH Dossiers patients (Impact soins: 4, Impact financier: 4, Impact r√©glementaire: 5)',
            'PACS Imagerie (Impact soins: 4, Impact financier: 3, Impact r√©glementaire: 3)',
            'Laboratoires analyses (Impact soins: 3, Impact financier: 3, Impact r√©glementaire: 3)',
            'Pharmacie hospitali√®re (Impact soins: 3, Impact financier: 2, Impact r√©glementaire: 3)',
            'Recherche clinique (Impact soins: 2, Impact financier: 3, Impact r√©glementaire: 2)',
            'Gestion administrative (Impact soins: 1, Impact financier: 3, Impact r√©glementaire: 2)',
            'Centre de donn√©es (Impact soins: 5, Impact financier: 4, Impact r√©glementaire: 4)'
          ],
          correctAnswer: {
            'CRITIQUE (Score 5)': ['Urgences vitales', 'SIH Dossiers patients', 'Centre de donn√©es'],
            'MAJEUR (Score 4)': ['PACS Imagerie'],
            'MOD√âR√â (Score 3)': ['Laboratoires analyses', 'Pharmacie hospitali√®re'],
            'MINEUR (Score 2-1)': ['Recherche clinique', 'Gestion administrative']
          },
          explanation: `**Grille BIA sp√©cialis√©e sant√© :**

Score = MAX(Impact soins, Impact financier, Impact r√©glementaire)

üî¥ **CRITIQUE (5)** : Vies en jeu, responsabilit√© p√©nale
üü† **MAJEUR (4)** : Impact patient significatif
üü° **MOD√âR√â (3)** : G√™ne op√©rationnelle
üü¢ **MINEUR (1-2)** : Impact limit√©`,
          points: 35,
          expertTips: ['L\'impact soins prime en milieu hospitalier', 'Le score max d√©termine la criticit√© globale']
        }
      ],
      context: {
        hospitalType: 'CHU M√©tropolitain',
        bedCount: 1200,
        sites: 3,
        employees: 3500,
        budget: '450M‚Ç¨/an',
        specialties: ['Urgences', 'R√©animation', 'Cardiologie', 'Neurochirurgie', 'Oncologie', 'P√©diatrie'],
        itInfrastructure: {
          systems: [
            { name: 'SIH Principal', type: 'ERP Sant√©', criticality: 'CRITIQUE', users: 3000, availability: '99.9%' },
            { name: 'PACS Imagerie', type: 'Imagerie m√©dicale', criticality: 'CRITIQUE', users: 500, availability: '99.8%' },
            { name: 'LIS Laboratoires', type: 'Gestion laboratoire', criticality: 'MAJEUR', users: 200, availability: '99.5%' }
          ],
          networks: [
            { name: 'R√©seau m√©dical', type: 'VLAN s√©curis√©', coverage: '3 sites', security: 'WPA3 Enterprise' },
            { name: 'R√©seau administratif', type: 'VLAN standard', coverage: '3 sites', security: 'WPA2' }
          ],
          servers: { physical: 200, virtual: 800, locations: ['Site Principal', 'Site Sp√©cialis√©', 'Cloud HDS'] },
          applications: [
            { name: 'Dossier Patient Informatis√©', type: 'M√©tier critique', criticality: 'CRITIQUE', users: 2800 },
            { name: 'Gestion Administrative', type: 'Support', criticality: 'MAJEUR', users: 700 },
            { name: 'Recherche Clinique', type: 'Sp√©cialis√©', criticality: 'MOD√âR√â', users: 150 }
          ]
        },
        regulatoryRequirements: ['HDS', 'RGPD', 'HAS', 'ANSSI', 'Code de la sant√© publique'],
        operationalConstraints: [
          { type: 'Continuit√©', description: 'Soins 24h/24', impact: 'Vies en jeu', mitigation: 'Redondance totale' },
          { type: 'R√©glementaire', description: 'Conformit√© HDS', impact: 'Fermeture', mitigation: 'Audit permanent' },
          { type: 'Qualit√©', description: 'Certification HAS', impact: 'Perte accr√©ditation', mitigation: 'Contr√¥le qualit√©' }
        ],
        partners: [
          { name: 'Laboratoires Externes', type: 'Prestataire critique', criticality: 'CRITIQUE', services: ['Analyses urgentes', 'Analyses sp√©cialis√©es'] },
          { name: 'Maintenance Biom√©dicale', type: 'Prestataire', criticality: 'MAJEUR', services: ['√âquipements vitaux', 'Maintenance pr√©ventive'] },
          { name: '√âditeur SIH', type: 'Fournisseur unique', criticality: 'CRITIQUE', services: ['Support 24h/24', 'Mises √† jour'] }
        ]
      },
      learningObjectives: [
        'Appliquer la m√©thodologie ANSSI d\'identification des biens essentiels',
        'Ma√Ætriser la grille BIA adapt√©e au secteur sant√©',
        'Classifier les biens selon leur criticit√© m√©tier',
        'Justifier les choix avec impacts sectoriels'
      ],
      realWorldExample: 'Inventaire biens essentiels CHU Toulouse (certification HAS 2023)',
      anssiCompliance: ['Guide EBIOS RM v1.5 - Identification biens essentiels', 'M√©thode BIA ANSSI adapt√©e sant√©']
    };
  }

  // ü•â EXERCICE 3 - √âCOSYST√àME ET D√âPENDANCES (25 MIN, 100 PTS)
  static getExercise3_EcosystemMapping(): SecurityFoundationExercise {
    return {
      id: 'exercise_3_ecosystem_mapping',
      title: '√âcosyst√®me et D√©pendances',
      description: 'Cartographier l\'√©cosyst√®me et analyser les d√©pendances critiques du CHU',
      type: 'ecosystem_mapping',
      difficulty: 'advanced',
      duration: 25,
      points: 100,
      category: 'Analyse des d√©pendances',
      scenario: {
        id: 'chu_ecosystem_analysis',
        title: 'CHU interconnect√© - 25 partenaires et 15 fournisseurs critiques',
        description: 'Analyser l\'√©cosyst√®me complexe du CHU et identifier les risques de d√©pendance',
        context: `Le CHU M√©tropolitain op√®re dans un √©cosyst√®me complexe avec de nombreuses interd√©pendances.
        Objectif : Cartographier les d√©pendances critiques et √©valuer les risques en cascade.`,
        constraints: [
          'Continuit√© soins 24h/24 non n√©gociable',
          'Fournisseurs uniques pour certains syst√®mes critiques',
          'Contraintes g√©ographiques (sites distants)',
          'R√©glementations sp√©cifiques h√©bergement donn√©es sant√©'
        ],
        stakeholders: [
          'Direction G√©n√©rale', 'RSSI', 'DSI', 'Direction Achats',
          'Responsables partenariats', 'Chefs de service', 'Directeur Qualit√©'
        ],
        expectedOutcome: 'Cartographie compl√®te avec strat√©gies de mitigation'
      },
      questions: [
        {
          id: 'q1_ecosystem_mapping',
          question: 'Cartographiez l\'√©cosyst√®me CHU en identifiant les d√©pendances critiques :',
          type: 'multiple_select',
          options: [
            '√âditeur SIH (fournisseur unique, maintenance 24h/24)',
            'Microsoft Cloud (h√©bergement Office 365, Teams)',
            'Op√©rateur t√©l√©com principal (connectivit√© sites)',
            'Laboratoires externes (analyses urgentes)',
            'Prestataires maintenance biom√©dicale (√©quipements vitaux)',
            'Fournisseur PACS (imagerie m√©dicale)',
            '√âtablissements partenaires (transferts patients)',
            'R√©seaux sant√© r√©gionaux (√©changes s√©curis√©s)',
            'Organismes tutelle (ARS, CPAM)',
            'Prestataires nettoyage (acc√®s locaux sensibles)'
          ],
          correctAnswer: [
            '√âditeur SIH (fournisseur unique, maintenance 24h/24)',
            'Op√©rateur t√©l√©com principal (connectivit√© sites)',
            'Laboratoires externes (analyses urgentes)',
            'Prestataires maintenance biom√©dicale (√©quipements vitaux)',
            'Fournisseur PACS (imagerie m√©dicale)'
          ],
          explanation: `**D√©pendances critiques identifi√©es :**

üî¥ **CRITIQUES (impact imm√©diat sur soins) :**
- √âditeur SIH : Fournisseur unique, arr√™t = paralysie
- Op√©rateur t√©l√©com : Connectivit√© vitale inter-sites
- Laboratoires externes : Analyses urgences vitales
- Maintenance biom√©dicale : √âquipements patients
- Fournisseur PACS : Imagerie diagnostique

üü° **IMPORTANTES (impact diff√©r√©) :**
- Microsoft Cloud, partenaires, r√©seaux r√©gionaux

üü¢ **SECONDAIRES :**
- Tutelle, nettoyage (impact limit√© court terme)`,
          points: 30,
          hints: ['Focalisez sur l\'impact imm√©diat sur les soins', 'Identifiez les fournisseurs uniques'],
          expertTips: ['Une d√©pendance critique = arr√™t possible activit√© vitale', 'Priorisez selon RTO des biens essentiels']
        },
        {
          id: 'q2_dependency_risk_analysis',
          question: '√âvaluez les risques de d√©pendance selon la matrice Probabilit√© √ó Impact :',
          type: 'matrix_analysis',
          options: [
            'D√©faillance √©diteur SIH (Probabilit√©: 2/5, Impact: 5/5)',
            'Panne op√©rateur t√©l√©com principal (Probabilit√©: 3/5, Impact: 4/5)',
            'Cyberattaque fournisseur cloud (Probabilit√©: 3/5, Impact: 3/5)',
            'D√©faillance laboratoire externe (Probabilit√©: 2/5, Impact: 4/5)',
            'Panne maintenance biom√©dicale (Probabilit√©: 3/5, Impact: 3/5)',
            'Compromission fournisseur PACS (Probabilit√©: 2/5, Impact: 3/5)'
          ],
          correctAnswer: {
            'CRITIQUE (Score 12-15)': ['Panne op√©rateur t√©l√©com principal (Score 12)'],
            '√âLEV√â (Score 8-11)': ['D√©faillance √©diteur SIH (Score 10)', 'D√©faillance laboratoire externe (Score 8)', 'Cyberattaque fournisseur cloud (Score 9)', 'Panne maintenance biom√©dicale (Score 9)'],
            'MOD√âR√â (Score 4-7)': ['Compromission fournisseur PACS (Score 6)']
          },
          explanation: `**Matrice de risque d√©pendance :**

Score = Probabilit√© √ó Impact

üî¥ **CRITIQUE (12-15)** : Action imm√©diate requise
üü† **√âLEV√â (8-11)** : Surveillance renforc√©e
üü° **MOD√âR√â (4-7)** : Surveillance standard

**Priorisation :**
1. Op√©rateur t√©l√©com (3√ó4=12) - Double op√©rateur urgent
2. √âditeur SIH (2√ó5=10) - Contrat renforc√©
3. Cloud/Laboratoire/Maintenance (9) - Plans de continuit√©`,
          points: 35,
          expertTips: ['La probabilit√© √©value la fr√©quence historique', 'L\'impact mesure l\'effet sur les biens essentiels']
        }
      ],
      context: {
        hospitalType: 'CHU M√©tropolitain',
        bedCount: 1200,
        sites: 3,
        employees: 3500,
        budget: '450M‚Ç¨/an',
        specialties: ['Urgences', 'R√©animation', 'Cardiologie', 'Neurochirurgie', 'Oncologie', 'P√©diatrie'],
        itInfrastructure: {
          systems: [
            { name: 'SIH Principal', type: 'ERP Sant√©', criticality: 'CRITIQUE', users: 3000, availability: '99.9%' },
            { name: 'PACS Imagerie', type: 'Imagerie m√©dicale', criticality: 'CRITIQUE', users: 500, availability: '99.8%' }
          ],
          networks: [
            { name: 'R√©seau m√©dical', type: 'VLAN s√©curis√©', coverage: '3 sites', security: 'WPA3 Enterprise' },
            { name: 'Liaison inter-sites', type: 'Fibre d√©di√©e', coverage: 'Multi-sites', security: 'VPN IPSec' }
          ],
          servers: { physical: 200, virtual: 800, locations: ['Site Principal', 'Site Sp√©cialis√©', 'Cloud HDS'] },
          applications: [
            { name: 'Dossier Patient Informatis√©', type: 'M√©tier critique', criticality: 'CRITIQUE', users: 2800 },
            { name: 'Imagerie PACS', type: 'M√©tier critique', criticality: 'CRITIQUE', users: 500 }
          ]
        },
        regulatoryRequirements: ['HDS', 'RGPD', 'HAS', 'ANSSI', 'Code de la sant√© publique'],
        operationalConstraints: [
          { type: 'Continuit√©', description: 'Soins 24h/24', impact: 'Vies en jeu', mitigation: 'Redondance totale' },
          { type: 'G√©ographique', description: '3 sites distants', impact: 'Complexit√© r√©seau', mitigation: 'Liaisons multiples' },
          { type: 'Fournisseur unique', description: 'SIH sans alternative', impact: 'D√©pendance critique', mitigation: 'Contrat renforc√©' }
        ],
        partners: [
          { name: '√âditeur SIH', type: 'Fournisseur unique', criticality: 'CRITIQUE', services: ['Support 24h/24', 'Maintenance', '√âvolutions'] },
          { name: 'Laboratoires Externes', type: 'Prestataire critique', criticality: 'CRITIQUE', services: ['Analyses urgentes', 'Analyses sp√©cialis√©es'] },
          { name: 'Op√©rateur T√©l√©com', type: 'Fournisseur infrastructure', criticality: 'CRITIQUE', services: ['Connectivit√©', 'Internet', 'VPN'] },
          { name: 'Maintenance Biom√©dicale', type: 'Prestataire', criticality: 'MAJEUR', services: ['√âquipements vitaux', 'Maintenance pr√©ventive'] },
          { name: 'Microsoft Cloud', type: 'Fournisseur cloud', criticality: 'MAJEUR', services: ['Office 365', 'Teams', 'OneDrive'] }
        ]
      },
      learningObjectives: [
        'Cartographier l\'√©cosyst√®me num√©rique complexe du CHU',
        'Identifier les d√©pendances critiques externes',
        'Analyser les risques de la cha√Æne d\'approvisionnement',
        '√âvaluer les impacts des d√©faillances en cascade'
      ],
      realWorldExample: 'Analyse d√©pendances CHU Lille post-incident op√©rateur (2022)',
      anssiCompliance: ['Guide EBIOS RM - Analyse √©cosyst√®me', 'R√©f√©rentiel supply chain security ANSSI']
    };
  }

  // üéØ EXERCICE 4 - OBJECTIFS DE S√âCURIT√â CHU (20 MIN, 80 PTS)
  static getExercise4_SecurityObjectives(): SecurityFoundationExercise {
    return {
      id: 'exercise_4_security_objectives',
      title: 'Objectifs de S√©curit√© CHU',
      description: 'D√©finir des objectifs de s√©curit√© adapt√©s aux contraintes hospitali√®res',
      type: 'security_objectives',
      difficulty: 'intermediate',
      duration: 20,
      points: 80,
      category: 'Objectifs de s√©curit√©',
      scenario: {
        id: 'chu_security_objectives',
        title: 'D√©finition des objectifs DICP pour 8 syst√®mes critiques CHU',
        description: 'D√©finir les objectifs de s√©curit√© (Disponibilit√©, Int√©grit√©, Confidentialit√©, Preuve) adapt√©s au CHU',
        context: `Mission : D√©finir des objectifs de s√©curit√© r√©alistes et conformes aux contraintes hospitali√®res.
        Contrainte : √âquilibrer exigences m√©tier et faisabilit√© technique.`,
        constraints: [
          'Secret m√©dical : Protection absolue donn√©es patients',
          'Continuit√© vitale : Tol√©rance z√©ro pour urgences',
          'Tra√ßabilit√© l√©gale : Conservation 7 ans minimum',
          'Conformit√© HDS : Exigences techniques strictes'
        ],
        stakeholders: [
          'Directeur M√©dical', 'RSSI', 'DSI', 'Directeur Qualit√©',
          'Chef p√¥le Urgences', 'Directeur Soins', 'DPO'
        ],
        expectedOutcome: 'Objectifs DICP valid√©s et mesurables'
      },
      questions: [
        {
          id: 'q1_availability_objectives',
          question: 'D√©finissez les seuils de disponibilit√© adapt√©s √† chaque syst√®me :',
          type: 'multiple_choice',
          options: [
            'Urgences vitales : 99.99% (52min arr√™t max/an)',
            'SIH principal : 99.9% (8h arr√™t max/an)',
            'PACS imagerie : 99.8% (17h arr√™t max/an)',
            'Laboratoires : 99.5% (44h arr√™t max/an)',
            'Pharmacie : 99% (87h arr√™t max/an)',
            'Administration : 98% (175h arr√™t max/an)'
          ],
          correctAnswer: [
            'Urgences vitales : 99.99% (52min arr√™t max/an)',
            'SIH principal : 99.9% (8h arr√™t max/an)',
            'PACS imagerie : 99.8% (17h arr√™t max/an)',
            'Laboratoires : 99.5% (44h arr√™t max/an)'
          ],
          explanation: `**Seuils de disponibilit√© justifi√©s :**

üî¥ **99.99% Urgences** : Vies en jeu, tol√©rance minimale
üü† **99.9% SIH** : Activit√© hospitali√®re globale
üü° **99.8% PACS** : Imagerie diagnostique critique
üü¢ **99.5% Laboratoires** : Analyses diff√©rables partiellement

**Calcul temps d'arr√™t annuel :**
- 99.99% = 52 minutes max
- 99.9% = 8h45 max
- 99.8% = 17h30 max`,
          points: 25,
          hints: ['Les urgences ont la priorit√© absolue', 'Calculez le temps d\'arr√™t acceptable'],
          expertTips: ['Alignez sur les RTO des biens essentiels', 'Validez la faisabilit√© technique']
        },
        {
          id: 'q2_integrity_requirements',
          question: 'Classez ces donn√©es par niveau d\'int√©grit√© requis :',
          type: 'ranking',
          options: [
            'Prescriptions m√©dicales',
            'Dossiers patients',
            'Images m√©dicales diagnostiques',
            'R√©sultats laboratoires',
            'Donn√©es administratives patients',
            'Donn√©es de recherche clinique',
            'Donn√©es RH personnel',
            'Donn√©es financi√®res'
          ],
          correctAnswer: [
            'Prescriptions m√©dicales',
            'Dossiers patients',
            'Images m√©dicales diagnostiques',
            'R√©sultats laboratoires',
            'Donn√©es administratives patients',
            'Donn√©es de recherche clinique',
            'Donn√©es RH personnel',
            'Donn√©es financi√®res'
          ],
          explanation: `**Hi√©rarchie int√©grit√© secteur sant√© :**

ü•á **100% int√®gres (vies en jeu) :**
- Prescriptions : Erreur = danger vital
- Dossiers patients : Base d√©cisions m√©dicales

ü•à **Tr√®s haute int√©grit√© :**
- Images diagnostiques : Erreurs diagnostic
- R√©sultats laboratoires : D√©cisions th√©rapeutiques

ü•â **Haute int√©grit√© :**
- Donn√©es administratives, recherche, RH, finances`,
          points: 20,
          expertTips: ['L\'int√©grit√© suit l\'impact sur les soins', 'Les donn√©es vitales sont 100% int√®gres']
        }
      ],
      context: {
        hospitalType: 'CHU M√©tropolitain',
        bedCount: 1200,
        sites: 3,
        employees: 3500,
        budget: '450M‚Ç¨/an',
        specialties: ['Urgences', 'R√©animation', 'Cardiologie', 'Neurochirurgie', 'Oncologie', 'P√©diatrie'],
        itInfrastructure: {
          systems: [
            { name: 'Urgences vitales', type: 'Processus critique', criticality: 'CRITIQUE', users: 200, availability: '99.99%' },
            { name: 'SIH Principal', type: 'ERP Sant√©', criticality: 'CRITIQUE', users: 3000, availability: '99.9%' },
            { name: 'PACS Imagerie', type: 'Imagerie m√©dicale', criticality: 'CRITIQUE', users: 500, availability: '99.8%' },
            { name: 'Laboratoires', type: 'Analyses m√©dicales', criticality: 'MAJEUR', users: 150, availability: '99.5%' }
          ],
          networks: [
            { name: 'R√©seau m√©dical', type: 'VLAN s√©curis√©', coverage: '3 sites', security: 'WPA3 Enterprise' }
          ],
          servers: { physical: 200, virtual: 800, locations: ['Site Principal', 'Site Sp√©cialis√©', 'Cloud HDS'] },
          applications: [
            { name: 'Prescriptions √©lectroniques', type: 'M√©tier vital', criticality: 'CRITIQUE', users: 2800 },
            { name: 'Dossier Patient Informatis√©', type: 'M√©tier critique', criticality: 'CRITIQUE', users: 2800 }
          ]
        },
        regulatoryRequirements: ['HDS', 'RGPD', 'HAS', 'ANSSI', 'Code de la sant√© publique', 'Secret m√©dical'],
        operationalConstraints: [
          { type: 'Continuit√© vitale', description: 'Urgences 24h/24', impact: 'Vies en jeu', mitigation: 'Redondance totale' },
          { type: 'Secret m√©dical', description: 'Confidentialit√© absolue', impact: 'Sanctions p√©nales', mitigation: 'Chiffrement + contr√¥les' },
          { type: 'Tra√ßabilit√©', description: 'Conservation 7 ans', impact: 'Obligations l√©gales', mitigation: 'Archivage s√©curis√©' }
        ],
        partners: [
          { name: 'ANSSI', type: 'Autorit√©', criticality: 'MAJEUR', services: ['Homologation', 'Contr√¥les'] },
          { name: 'CNIL', type: 'Autorit√©', criticality: 'MAJEUR', services: ['Conformit√© RGPD', 'Audits'] }
        ]
      },
      learningObjectives: [
        'D√©finir des objectifs de s√©curit√© DICP adapt√©s au CHU',
        '√âquilibrer exigences m√©tier et faisabilit√© technique',
        'Int√©grer les contraintes r√©glementaires sp√©cifiques sant√©',
        'Mesurer et valider les objectifs d√©finis'
      ],
      realWorldExample: 'Objectifs s√©curit√© CHU Bordeaux (certification HDS 2023)',
      anssiCompliance: ['Guide EBIOS RM - Objectifs de s√©curit√©', 'R√©f√©rentiel HDS ANSSI']
    };
  }

  // üèõÔ∏è EXERCICE 5 - SIMULATION COMIT√â VALIDATION (20 MIN, 100 PTS)
  static getExercise5_GovernanceSimulation(): SecurityFoundationExercise {
    return {
      id: 'exercise_5_governance_simulation',
      title: 'Simulation Comit√© Validation',
      description: 'Ma√Ætriser la pr√©sentation et validation des biens essentiels en comit√©',
      type: 'governance_simulation',
      difficulty: 'expert',
      duration: 20,
      points: 100,
      category: 'Gouvernance et validation',
      scenario: {
        id: 'chu_validation_committee',
        title: 'Comit√© de validation multidisciplinaire CHU avec 7 participants',
        description: 'Pr√©senter et faire valider l\'inventaire des biens essentiels par le comit√© multidisciplinaire',
        context: `Situation : Vous devez pr√©senter vos conclusions d'analyse des biens essentiels au comit√© de validation.
        Enjeu : Obtenir la validation officielle pour poursuivre l'analyse EBIOS RM.`,
        constraints: [
          'Comit√© multidisciplinaire avec enjeux divergents',
          'Temps de pr√©sentation limit√© (30 minutes)',
          'Objections m√©tier pr√©visibles',
          'Validation unanime requise pour poursuivre'
        ],
        stakeholders: [
          'Directeur G√©n√©ral (enjeux strat√©giques)',
          'Directeur M√©dical (enjeux soins)',
          'Chef p√¥le Urgences (contraintes op√©rationnelles)',
          'Directeur Soins (organisation infirmi√®re)',
          'RSSI (s√©curit√© technique)',
          'DSI (faisabilit√© technique)',
          'Directeur Qualit√© (conformit√© r√©glementaire)'
        ],
        expectedOutcome: 'Validation unanime avec plan d\'action A2'
      },
      questions: [
        {
          id: 'q1_presentation_structure',
          question: 'Structurez votre pr√©sentation de 30 minutes pour maximiser l\'adh√©sion :',
          type: 'ranking',
          options: [
            'Introduction : Contexte et enjeux CHU (5 min)',
            'M√©thodologie : Approche ANSSI adapt√©e sant√© (5 min)',
            'R√©sultats : Top 10 biens essentiels avec justifications (15 min)',
            'Impacts : Cons√©quences op√©rationnelles et financi√®res (3 min)',
            'Recommandations : Prochaines √©tapes Atelier 2 (2 min)'
          ],
          correctAnswer: [
            'Introduction : Contexte et enjeux CHU (5 min)',
            'M√©thodologie : Approche ANSSI adapt√©e sant√© (5 min)',
            'R√©sultats : Top 10 biens essentiels avec justifications (15 min)',
            'Impacts : Cons√©quences op√©rationnelles et financi√®res (3 min)',
            'Recommandations : Prochaines √©tapes Atelier 2 (2 min)'
          ],
          explanation: `**Structure optimale de pr√©sentation :**

üéØ **Introduction (5 min)** : Cadrer les enjeux
üìã **M√©thodologie (5 min)** : Rassurer sur l'approche
üìä **R√©sultats (15 min)** : C≈ìur de la pr√©sentation
üí∞ **Impacts (3 min)** : Convaincre de l'urgence
üöÄ **Recommandations (2 min)** : Mobiliser pour l'action

**Cl√© du succ√®s :** 50% du temps sur les r√©sultats avec justifications m√©tier`,
          points: 30,
          expertTips: ['Adaptez le discours √† chaque interlocuteur', 'Pr√©parez les objections pr√©visibles']
        },
        {
          id: 'q2_objection_management',
          question: 'Le Chef des Urgences conteste : "Vous classez les urgences en CRITIQUE mais nous n\'avons jamais eu de panne majeure". Comment r√©pondez-vous ?',
          type: 'scenario_analysis',
          options: [
            'Reformuler : "Vous confirmez donc que les urgences sont vitales ?"',
            'Argumenter : "L\'absence de panne pass√©e ne garantit pas l\'avenir"',
            'Illustrer : "Une panne de 4h = combien de vies en danger ?"',
            'R√©glementaire : "L\'ANSSI impose cette classification pour les urgences"',
            'Compromis : "Proposons MAJEUR si vous pr√©f√©rez ?"'
          ],
          correctAnswer: ['Reformuler : "Vous confirmez donc que les urgences sont vitales ?"', 'Illustrer : "Une panne de 4h = combien de vies en danger ?"'],
          explanation: `**Gestion d'objection efficace :**

‚úÖ **Reformulation** : Faire dire l'importance par l'objecteur
‚úÖ **Illustration concr√®te** : Impact vies humaines parlant
‚ùå **Argument historique** : Faible face √† l'exp√©rience terrain
‚ùå **Autorit√© r√©glementaire** : Peut braquer
‚ùå **Compromis** : Affaiblit la position technique

**Technique :** Transformer l'objection en validation de l'importance`,
          points: 40,
          expertTips: ['Utilisez l\'expertise m√©tier de l\'objecteur', 'Restez sur les faits et impacts']
        }
      ],
      context: {
        hospitalType: 'CHU M√©tropolitain',
        bedCount: 1200,
        sites: 3,
        employees: 3500,
        budget: '450M‚Ç¨/an',
        specialties: ['Urgences', 'R√©animation', 'Cardiologie', 'Neurochirurgie', 'Oncologie', 'P√©diatrie'],
        itInfrastructure: {
          systems: [
            { name: 'SIH Principal', type: 'ERP Sant√©', criticality: 'CRITIQUE', users: 3000, availability: '99.9%' }
          ],
          networks: [
            { name: 'R√©seau m√©dical', type: 'VLAN s√©curis√©', coverage: '3 sites', security: 'WPA3 Enterprise' }
          ],
          servers: { physical: 200, virtual: 800, locations: ['Site Principal', 'Site Sp√©cialis√©', 'Cloud HDS'] },
          applications: [
            { name: 'Dossier Patient Informatis√©', type: 'M√©tier critique', criticality: 'CRITIQUE', users: 2800 }
          ]
        },
        regulatoryRequirements: ['HDS', 'RGPD', 'HAS', 'ANSSI', 'Code de la sant√© publique'],
        operationalConstraints: [
          { type: 'Gouvernance', description: 'Validation comit√© obligatoire', impact: 'Blocage projet', mitigation: 'Pr√©paration rigoureuse' },
          { type: 'Multidisciplinaire', description: 'Enjeux divergents', impact: 'Conflits int√©r√™ts', mitigation: 'Communication adapt√©e' }
        ],
        partners: [
          { name: 'Comit√© de Direction', type: 'Gouvernance', criticality: 'CRITIQUE', services: ['Validation strat√©gique', 'Arbitrage'] }
        ]
      },
      learningObjectives: [
        'Ma√Ætriser la pr√©sentation en comit√© multidisciplinaire',
        'G√©rer les objections et conflits d\'int√©r√™ts',
        'Adapter la communication par type d\'interlocuteur',
        'Obtenir une validation unanime et actionnable'
      ],
      realWorldExample: 'Comit√©s de validation post-incident WannaCry (2017)',
      anssiCompliance: ['Guide gouvernance s√©curit√© ANSSI', 'Bonnes pratiques comit√©s s√©curit√©']
    };
  }

  // üéØ M√âTHODES UTILITAIRES
  static getAllExercises(): SecurityFoundationExercise[] {
    return [
      this.getExercise1_ScopingAnalysis(),
      this.getExercise2_AssetIdentification(),
      this.getExercise3_EcosystemMapping(),
      this.getExercise4_SecurityObjectives(),
      this.getExercise5_GovernanceSimulation()
    ];
  }

  static getExerciseById(exerciseId: string): SecurityFoundationExercise | undefined {
    return this.getAllExercises().find(ex => ex.id === exerciseId);
  }

  static getExercisesByDifficulty(difficulty: 'intermediate' | 'advanced' | 'expert'): SecurityFoundationExercise[] {
    return this.getAllExercises().filter(ex => ex.difficulty === difficulty);
  }

  static getTotalDuration(): number {
    return this.getAllExercises().reduce((total, ex) => total + ex.duration, 0);
  }

  static getTotalPoints(): number {
    return this.getAllExercises().reduce((total, ex) => total + ex.points, 0);
  }
}
