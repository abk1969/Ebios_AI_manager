/**
 * üéØ EXERCICES PRATIQUES ATELIER 2 - SOURCES DE RISQUE
 * Exercices sp√©cialis√©s pour ma√Ætriser l'identification et l'analyse des sources de risque CHU
 */

// üéØ TYPES POUR LES EXERCICES ATELIER 2
export interface RiskSourceExercise {
  id: string;
  title: string;
  description: string;
  type: 'external_sources' | 'internal_threats' | 'supply_chain' | 'threat_intelligence' | 'governance_simulation';
  difficulty: 'intermediate' | 'advanced' | 'expert';
  duration: number; // minutes
  points: number;
  category: string;
  scenario: ExerciseScenario;
  questions: ExerciseQuestion[];
  context: CHUThreatContext;
  learningObjectives: string[];
  realWorldExample: string;
  anssiCompliance: string[];
}

export interface ExerciseScenario {
  id: string;
  title: string;
  description: string;
  context: string;
  constraints: string[];
  stakeholders: string[];
  expectedOutcome: string;
  threatLandscape: ThreatLandscape;
}

export interface ThreatLandscape {
  year: string;
  sector: string;
  incidents: RecentIncident[];
  trends: ThreatTrend[];
  intelligence: ThreatIntelligence[];
}

export interface RecentIncident {
  date: string;
  target: string;
  type: string;
  impact: string;
  source: string;
}

export interface ThreatTrend {
  trend: string;
  description: string;
  impact: string;
  examples: string[];
}

export interface ThreatIntelligence {
  source: string;
  reliability: 'A' | 'B' | 'C' | 'D';
  confidence: 'high' | 'medium' | 'low';
  information: string;
  relevance: number; // 1-5
}

export interface ExerciseQuestion {
  id: string;
  question: string;
  type: 'multiple_choice' | 'multiple_select' | 'ranking' | 'threat_profiling' | 'scenario_analysis' | 'matrix_analysis';
  options?: string[];
  correctAnswer: any;
  explanation: string;
  points: number;
  hints?: string[];
  commonMistakes?: string[];
  expertTips?: string[];
  threatIntelligence?: ThreatIntelligence[];
}

export interface CHUThreatContext {
  hospitalType: string;
  bedCount: number;
  sites: number;
  employees: number;
  budget: string;
  specialties: string[];
  essentialAssets: EssentialAssetRef[];
  securityMaturity: number; // 1-5
  regulatoryRequirements: string[];
  operationalConstraints: OperationalConstraint[];
  ecosystem: EcosystemPartner[];
}

export interface EssentialAssetRef {
  id: string;
  name: string;
  criticality: 'CRITIQUE' | 'MAJEUR' | 'MOD√âR√â' | 'MINEUR';
  attractiveness: number; // 1-5 pour les sources
}

export interface OperationalConstraint {
  type: string;
  description: string;
  impact: string;
  mitigation: string;
}

export interface EcosystemPartner {
  name: string;
  type: string;
  criticality: string;
  services: string[];
  riskLevel: number;
}

/**
 * üéØ CLASSE PRINCIPALE DES EXERCICES ATELIER 2
 */
export class RiskSourcesExercises {
  
  // ü•á EXERCICE 1 - IDENTIFICATION SOURCES EXTERNES (30 MIN, 100 PTS)
  static getExercise1_ExternalSources(): RiskSourceExercise {
    return {
      id: 'exercise_1_external_sources',
      title: 'Identification Sources Externes',
      description: 'Ma√Ætriser l\'identification des sources externes sp√©cialis√©es sant√©',
      type: 'external_sources',
      difficulty: 'advanced',
      duration: 30,
      points: 100,
      category: 'Sources externes',
      scenario: {
        id: 'chu_threat_landscape_2024',
        title: 'CHU M√©tropolitain - Analyse threat landscape secteur sant√© 2024',
        description: 'Analyser le paysage des menaces sp√©cifiques au secteur sant√© pour identifier les sources prioritaires',
        context: `Mission : Identifier et prioriser les sources de risque externes mena√ßant le CHU M√©tropolitain.
        Contrainte : Utiliser la threat intelligence 2024 actualis√©e et les incidents r√©cents du secteur.`,
        constraints: [
          'Threat intelligence 2024 actualis√©e obligatoire',
          'Focus sur les sources sp√©cialis√©es sant√©',
          'Priorisation selon attractivit√© CHU',
          'Validation avec incidents r√©cents secteur'
        ],
        stakeholders: [
          'RSSI', 'CERT Sant√©', 'Direction M√©dicale', 'DSI',
          'Threat Intelligence Analyst', 'SOC Manager'
        ],
        expectedOutcome: 'Top 15 sources externes prioris√©es avec justifications',
        threatLandscape: {
          year: '2024',
          sector: 'Sant√©',
          incidents: [
            { date: '2024-Q1', target: 'CHU europ√©ens', type: 'Ransomware', impact: 'Paralysie 3-7 jours', source: 'LockBit 3.0' },
            { date: '2024-Q2', target: 'Laboratoires US', type: 'Exfiltration', impact: '2M dossiers patients', source: 'APT chinois' },
            { date: '2024-Q3', target: 'H√¥pitaux UK', type: 'Supply chain', impact: 'Compromission SIH', source: '√âditeur compromis' }
          ],
          trends: [
            { trend: 'Sp√©cialisation sant√©', description: 'Groupes d√©di√©s au secteur m√©dical', impact: 'Efficacit√© accrue', examples: ['Ryuk successeurs', 'Conti √©volutions'] },
            { trend: 'Double extorsion', description: 'Chiffrement + menace publication', impact: 'Pression maximale', examples: ['LockBit', 'BlackCat'] },
            { trend: 'Supply chain', description: 'Attaques via fournisseurs', impact: 'Propagation massive', examples: ['SolarWinds sant√©', 'Kaseya MSP'] }
          ],
          intelligence: [
            { source: 'CERT Sant√©', reliability: 'A', confidence: 'high', information: '70% h√¥pitaux cibl√©s ransomware 2024', relevance: 5 },
            { source: 'ANSSI', reliability: 'A', confidence: 'high', information: 'APT chinois ciblent recherche COVID', relevance: 4 },
            { source: 'HC3 US', reliability: 'B', confidence: 'medium', information: 'Trafic donn√©es sant√© +300% dark web', relevance: 5 }
          ]
        }
      },
      questions: [
        {
          id: 'q1_cybercriminals_profiling',
          question: 'Identifiez et profilez les 3 groupes cybercriminels les plus mena√ßants pour le CHU :',
          type: 'threat_profiling',
          options: [
            'LockBit 3.0 - Ransomware sp√©cialis√© infrastructures critiques',
            'BlackCat/ALPHV - Double extorsion avec leak sites',
            'Conti successeurs - Expertise secteur sant√© d√©velopp√©e',
            'Lazarus (Cor√©e du Nord) - Financement programme nucl√©aire',
            'APT40 (Chine) - Espionnage recherche m√©dicale',
            'FIN7 - Fraude financi√®re et vol donn√©es',
            'Script kiddies - Attaques opportunistes non cibl√©es',
            'REvil successeurs - Ransomware-as-a-Service'
          ],
          correctAnswer: [
            'LockBit 3.0 - Ransomware sp√©cialis√© infrastructures critiques',
            'Conti successeurs - Expertise secteur sant√© d√©velopp√©e', 
            'APT40 (Chine) - Espionnage recherche m√©dicale'
          ],
          explanation: `**Top 3 sources cybercriminelles pour CHU :**

ü•á **LockBit 3.0** : Sp√©cialisation infrastructures critiques
- Motivation : Ran√ßons √©lev√©es (1-10M‚Ç¨)
- Capacit√©s : Techniques avanc√©es, double extorsion
- Historique : 40% attaques h√¥pitaux 2024

ü•à **Conti successeurs** : Expertise secteur sant√©
- Motivation : Connaissance sp√©cialis√©e acquise
- Capacit√©s : R√©seaux √©tablis, outils d√©di√©s
- Historique : √âvolution post-d√©mant√®lement

ü•â **APT40 (Chine)** : Espionnage recherche m√©dicale
- Motivation : Intelligence √©conomique/g√©opolitique
- Capacit√©s : Sophistication √©tatique, persistance
- Historique : Campagnes COVID-19, vaccins`,
          points: 30,
          hints: ['Focalisez sur la sp√©cialisation sant√©', 'Analysez les motivations sp√©cifiques au CHU'],
          expertTips: ['Les groupes sp√©cialis√©s sont plus dangereux que les g√©n√©ralistes', 'L\'historique d\'attaques sant√© est pr√©dictif'],
          threatIntelligence: [
            { source: 'CERT Sant√©', reliability: 'A', confidence: 'high', information: 'LockBit responsable 40% ransomware sant√© 2024', relevance: 5 },
            { source: 'ANSSI', reliability: 'A', confidence: 'high', information: 'APT40 campagnes actives recherche m√©dicale', relevance: 4 }
          ]
        },
        {
          id: 'q2_state_threats_analysis',
          question: 'Analysez les menaces √©tatiques selon leurs objectifs g√©opolitiques :',
          type: 'matrix_analysis',
          options: [
            'Chine (APT1, APT40) - Espionnage recherche m√©dicale et vaccins',
            'Russie (APT28, APT29) - D√©stabilisation syst√®mes sant√© occidentaux',
            'Cor√©e du Nord (Lazarus) - Financement via ransomware et cryptojacking',
            'Iran (APT35) - Espionnage g√©opolitique donn√©es gouvernementales',
            '√âtats-Unis (NSA) - Surveillance globale communications',
            'Isra√´l (Unit 8200) - Cyber-d√©fense et contre-espionnage'
          ],
          correctAnswer: {
            'PRIORIT√â 1 (Impact direct CHU)': [
              'Chine (APT1, APT40) - Espionnage recherche m√©dicale et vaccins',
              'Russie (APT28, APT29) - D√©stabilisation syst√®mes sant√© occidentaux'
            ],
            'PRIORIT√â 2 (Impact indirect)': [
              'Cor√©e du Nord (Lazarus) - Financement via ransomware et cryptojacking'
            ],
            'PRIORIT√â 3 (Faible probabilit√©)': [
              'Iran (APT35) - Espionnage g√©opolitique donn√©es gouvernementales'
            ]
          },
          explanation: `**Analyse menaces √©tatiques par priorit√© :**

üî¥ **PRIORIT√â 1 - Impact direct :**
- **Chine** : Int√©r√™t strat√©gique recherche m√©dicale fran√ßaise
- **Russie** : D√©stabilisation infrastructures critiques occidentales

üü† **PRIORIT√â 2 - Impact indirect :**
- **Cor√©e du Nord** : Opportunisme financier (ransomware)

üü° **PRIORIT√â 3 - Faible probabilit√© :**
- **Iran** : Pas d'int√©r√™t sp√©cifique CHU r√©gional
- **Alli√©s** : Risque n√©gligeable (coop√©ration)`,
          points: 25,
          expertTips: ['Les motivations g√©opolitiques d√©terminent les cibles', 'L\'espionnage recherche m√©dicale est strat√©gique']
        }
      ],
      context: {
        hospitalType: 'CHU M√©tropolitain',
        bedCount: 1200,
        sites: 3,
        employees: 3500,
        budget: '450M‚Ç¨/an',
        specialties: ['Urgences', 'R√©animation', 'Cardiologie', 'Neurochirurgie', 'Oncologie', 'Recherche'],
        essentialAssets: [
          { id: 'urgences_vitales', name: 'Urgences vitales', criticality: 'CRITIQUE', attractiveness: 5 },
          { id: 'sih_patients', name: 'SIH Dossiers patients', criticality: 'CRITIQUE', attractiveness: 5 },
          { id: 'recherche_clinique', name: 'Recherche clinique', criticality: 'MAJEUR', attractiveness: 4 }
        ],
        securityMaturity: 3,
        regulatoryRequirements: ['HDS', 'RGPD', 'HAS', 'ANSSI'],
        operationalConstraints: [
          { type: 'Continuit√©', description: 'Soins 24h/24', impact: 'Vies en jeu', mitigation: 'Redondance' },
          { type: 'Attractivit√©', description: 'Donn√©es sant√© valoris√©es', impact: 'Cible privil√©gi√©e', mitigation: 'Protection renforc√©e' }
        ],
        ecosystem: [
          { name: '√âditeur SIH', type: 'Fournisseur unique', criticality: 'CRITIQUE', services: ['Support 24h/24'], riskLevel: 10 },
          { name: 'Laboratoires externes', type: 'Partenaire', criticality: 'CRITIQUE', services: ['Analyses urgentes'], riskLevel: 8 }
        ]
      },
      learningObjectives: [
        'Identifier les sources externes sp√©cialis√©es secteur sant√©',
        'Analyser les motivations des attaquants ciblant les h√¥pitaux',
        '√âvaluer les capacit√©s techniques et organisationnelles requises',
        'Prioriser les sources selon la menace pour le CHU'
      ],
      realWorldExample: 'Analyse threat intelligence post-attaques CHU europ√©ens Q1 2024',
      anssiCompliance: ['Guide EBIOS RM - Identification sources', 'M√©thode threat intelligence ANSSI']
    };
  }

  // ü•à EXERCICE 2 - ANALYSE MENACES INTERNES (25 MIN, 120 PTS)
  static getExercise2_InternalThreats(): RiskSourceExercise {
    return {
      id: 'exercise_2_internal_threats',
      title: 'Analyse Menaces Internes',
      description: 'Ma√Ætriser l\'analyse des risques internes sp√©cifiques au milieu hospitalier',
      type: 'internal_threats',
      difficulty: 'expert',
      duration: 25,
      points: 120,
      category: 'Menaces internes',
      scenario: {
        id: 'chu_internal_risk_assessment',
        title: 'CHU 3500 employ√©s - √âvaluation risques internes par profil',
        description: 'Analyser les risques internes en tenant compte des sp√©cificit√©s du milieu hospitalier',
        context: `Mission : √âvaluer les risques internes par cat√©gorie de personnel et d√©finir les profils √† risque.
        Contrainte : Int√©grer les facteurs de stress sp√©cifiques au milieu hospitalier.`,
        constraints: [
          'Analyse comportementale sp√©cialis√©e sant√©',
          'Facteurs de stress milieu hospitalier',
          'Statistiques incidents internes ANSSI',
          'Profils psychologiques √† risque'
        ],
        stakeholders: [
          'DRH', 'Direction M√©dicale', 'RSSI', 'M√©decin du travail',
          'Repr√©sentants syndicaux', 'Psychologue du travail'
        ],
        expectedOutcome: 'Matrice de risque interne avec mesures pr√©ventives',
        threatLandscape: {
          year: '2024',
          sector: 'Sant√©',
          incidents: [
            { date: '2024', target: 'H√¥pitaux fran√ßais', type: 'Menace interne', impact: '35% incidents s√©curit√©', source: 'Statistiques ANSSI' },
            { date: '2024', target: 'Personnel soignant', type: 'Burnout', impact: '40% taux √©puisement', source: 'Enqu√™te DREES' },
            { date: '2024', target: 'Administrateurs IT', type: 'Surcharge', impact: '60% en sous-effectif', source: 'Barom√®tre DSIH' }
          ],
          trends: [
            { trend: '√âpuisement professionnel', description: 'Burnout post-COVID persistant', impact: 'N√©gligence s√©curit√©', examples: ['Partage comptes', 'Proc√©dures contourn√©es'] },
            { trend: 'Turnover √©lev√©', description: 'Rotation personnel importante', impact: 'Formation insuffisante', examples: ['Int√©rimaires', 'Nouveaux arrivants'] },
            { trend: 'T√©l√©travail hybride', description: 'Travail √† distance partiel', impact: 'Contr√¥le r√©duit', examples: ['Acc√®s non s√©curis√©s', '√âquipements personnels'] }
          ],
          intelligence: [
            { source: 'ANSSI', reliability: 'A', confidence: 'high', information: '35% incidents s√©curit√© origine interne secteur sant√©', relevance: 5 },
            { source: 'CNIL', reliability: 'A', confidence: 'high', information: '60% violations RGPD sant√© par n√©gligence interne', relevance: 5 },
            { source: 'CERT Sant√©', reliability: 'B', confidence: 'medium', information: 'Corr√©lation burnout/incidents s√©curit√© observ√©e', relevance: 4 }
          ]
        }
      },
      questions: [
        {
          id: 'q1_medical_staff_profiling',
          question: 'Analysez les 4 profils m√©dicaux selon leur niveau de risque interne :',
          type: 'threat_profiling',
          options: [
            'M√©decin chef de service (20 ans anciennet√©, acc√®s √©tendu, pression hi√©rarchique)',
            'Infirmi√®re int√©rimaire (contrat 3 mois, formation express, stress adaptation)',
            'Interne en m√©decine (stage 6 mois, curiosit√© apprentissage, supervision variable)',
            'M√©decin urgentiste (10 ans exp√©rience, burnout √©lev√©, acc√®s privil√©gi√© urgences)'
          ],
          correctAnswer: {
            'RISQUE √âLEV√â': ['Infirmi√®re int√©rimaire (contrat 3 mois, formation express, stress adaptation)', 'M√©decin urgentiste (10 ans exp√©rience, burnout √©lev√©, acc√®s privil√©gi√© urgences)'],
            'RISQUE MOD√âR√â': ['Interne en m√©decine (stage 6 mois, curiosit√© apprentissage, supervision variable)'],
            'RISQUE FAIBLE': ['M√©decin chef de service (20 ans anciennet√©, acc√®s √©tendu, pression hi√©rarchique)']
          },
          explanation: `**Analyse risque par profil m√©dical :**

üî¥ **RISQUE √âLEV√â :**
- **Infirmi√®re int√©rimaire** : Formation insuffisante + stress adaptation + turnover
- **M√©decin urgentiste** : Burnout + acc√®s privil√©gi√© + pression temporelle

üü† **RISQUE MOD√âR√â :**
- **Interne m√©decine** : Curiosit√© + supervision variable (facteur d'apprentissage)

üü¢ **RISQUE FAIBLE :**
- **Chef de service** : Anciennet√© + responsabilit√© + formation compl√®te

**Facteurs aggravants :** Stress, formation insuffisante, acc√®s privil√©gi√©, burnout`,
          points: 35,
          hints: ['Analysez stress + acc√®s + formation', 'Le burnout est un facteur critique en sant√©'],
          expertTips: ['Les int√©rimaires cumulent les facteurs de risque', 'Le burnout corr√®le avec les incidents s√©curit√©']
        },
        {
          id: 'q2_technical_staff_assessment',
          question: '√âvaluez les risques du personnel technique selon la matrice Probabilit√© √ó Impact :',
          type: 'matrix_analysis',
          options: [
            'Administrateur IT (acc√®s root, surcharge travail, sous-effectifs) - P:4, I:5',
            'Technicien biom√©dical externe (acc√®s √©quipements, interventions urgentes) - P:3, I:4',
            'Personnel nettoyage nuit (acc√®s locaux sensibles, surveillance r√©duite) - P:3, I:2',
            'Stagiaire informatique (acc√®s temporaire, formation incompl√®te) - P:2, I:3',
            'Prestataire maintenance (acc√®s physique, √©quipements test) - P:3, I:4',
            'Agent s√©curit√© (acc√®s badges, rondes nocturnes) - P:2, I:2'
          ],
          correctAnswer: {
            'CRITIQUE (Score 16-20)': ['Administrateur IT (acc√®s root, surcharge travail, sous-effectifs) - P:4, I:5'],
            '√âLEV√â (Score 12-15)': ['Technicien biom√©dical externe (acc√®s √©quipements, interventions urgentes) - P:3, I:4', 'Prestataire maintenance (acc√®s physique, √©quipements test) - P:3, I:4'],
            'MOD√âR√â (Score 6-11)': ['Personnel nettoyage nuit (acc√®s locaux sensibles, surveillance r√©duite) - P:3, I:2', 'Stagiaire informatique (acc√®s temporaire, formation incompl√®te) - P:2, I:3'],
            'FAIBLE (Score 1-5)': ['Agent s√©curit√© (acc√®s badges, rondes nocturnes) - P:2, I:2']
          },
          explanation: `**Matrice de risque technique :**

Score = Probabilit√© √ó Impact

üî¥ **CRITIQUE (20)** : Admin IT - Acc√®s total + surcharge + sous-effectifs
üü† **√âLEV√â (12)** : Biom√©dicaux/Maintenance - Acc√®s critique + externe
üü° **MOD√âR√â (6-9)** : Nettoyage/Stagiaires - Acc√®s limit√© ou temporaire
üü¢ **FAIBLE (4)** : S√©curit√© - Acc√®s contr√¥l√© + formation

**Priorisation :** Admin IT > Prestataires techniques > Personnel support`,
          points: 30,
          expertTips: ['L\'acc√®s technique amplifie l\'impact', 'Les prestataires externes cumulent les risques']
        }
      ],
      context: {
        hospitalType: 'CHU M√©tropolitain',
        bedCount: 1200,
        sites: 3,
        employees: 3500,
        budget: '450M‚Ç¨/an',
        specialties: ['Urgences', 'R√©animation', 'Cardiologie', 'Neurochirurgie', 'Oncologie'],
        essentialAssets: [
          { id: 'urgences_vitales', name: 'Urgences vitales', criticality: 'CRITIQUE', attractiveness: 5 },
          { id: 'sih_patients', name: 'SIH Dossiers patients', criticality: 'CRITIQUE', attractiveness: 5 }
        ],
        securityMaturity: 3,
        regulatoryRequirements: ['HDS', 'RGPD', 'HAS', 'ANSSI'],
        operationalConstraints: [
          { type: 'Stress professionnel', description: 'Burnout post-COVID', impact: 'N√©gligence s√©curit√©', mitigation: 'Support psychologique' },
          { type: 'Turnover √©lev√©', description: 'Rotation 25%/an', impact: 'Formation insuffisante', mitigation: 'Onboarding renforc√©' },
          { type: 'Sous-effectifs', description: 'IT en tension', impact: 'Surcharge travail', mitigation: 'Recrutement prioritaire' }
        ],
        ecosystem: [
          { name: 'Personnel m√©dical', type: 'Interne', criticality: 'CRITIQUE', services: ['Soins patients'], riskLevel: 6 },
          { name: 'Personnel technique', type: 'Interne', criticality: 'CRITIQUE', services: ['Support IT'], riskLevel: 8 },
          { name: 'Prestataires', type: 'Externe', criticality: 'MAJEUR', services: ['Maintenance'], riskLevel: 7 }
        ]
      },
      learningObjectives: [
        'Identifier les menaces internes sp√©cifiques au milieu hospitalier',
        'Analyser les facteurs de risque du personnel m√©dical et technique',
        '√âvaluer l\'impact des prestataires et visiteurs',
        'D√©finir des profils de risque par cat√©gorie de personnel'
      ],
      realWorldExample: 'Analyse post-incident interne CHU Marseille (2023)',
      anssiCompliance: ['Guide EBIOS RM - Menaces internes', 'R√©f√©rentiel RH s√©curis√©es ANSSI']
    };
  }

  // ü•â EXERCICE 3 - √âCOSYST√àME ET SUPPLY CHAIN (25 MIN, 110 PTS)
  static getExercise3_SupplyChain(): RiskSourceExercise {
    return {
      id: 'exercise_3_supply_chain',
      title: '√âcosyst√®me et Supply Chain',
      description: 'Analyser les risques de la cha√Æne d\'approvisionnement sant√©',
      type: 'supply_chain',
      difficulty: 'advanced',
      duration: 25,
      points: 110,
      category: 'Cha√Æne d\'approvisionnement',
      scenario: {
        id: 'chu_supply_chain_analysis',
        title: 'CHU interconnect√© - 15 fournisseurs critiques, 25 partenaires',
        description: 'Analyser les risques de l\'√©cosyst√®me complexe du CHU et identifier les vuln√©rabilit√©s supply chain',
        context: `Mission : Analyser les risques de la cha√Æne d'approvisionnement et des partenaires critiques.
        Contrainte : √âvaluer les risques de propagation et les effets domino.`,
        constraints: [
          'D√©pendances critiques uniques (SIH, PACS)',
          'Interconnexions complexes (25 partenaires)',
          'R√©glementations sp√©cifiques (HDS, certification)',
          'Continuit√© soins non n√©gociable'
        ],
        stakeholders: [
          'Direction Achats', 'RSSI', 'DSI', 'Direction Partenariats',
          'Responsables contrats', 'Auditeurs externes'
        ],
        expectedOutcome: 'Cartographie risques supply chain avec strat√©gies mitigation',
        threatLandscape: {
          year: '2024',
          sector: 'Sant√©',
          incidents: [
            { date: '2024-Q1', target: '√âditeurs SIH', type: 'Compromission', impact: 'Backdoor 50+ h√¥pitaux', source: 'Supply chain attack' },
            { date: '2024-Q2', target: 'Microsoft 365', type: 'Panne globale', impact: '8h interruption', source: 'D√©faillance cloud' },
            { date: '2024-Q3', target: 'Laboratoires r√©seau', type: 'Propagation malware', impact: 'Contamination 15 sites', source: 'Mouvement lat√©ral' }
          ],
          trends: [
            { trend: 'Attaques supply chain', description: 'Compromission fournisseurs pour atteindre clients', impact: 'Propagation massive', examples: ['SolarWinds', 'Kaseya', 'Log4j'] },
            { trend: 'D√©pendances cloud', description: 'Concentration sur quelques acteurs', impact: 'Points de d√©faillance unique', examples: ['Microsoft', 'Google', 'AWS'] },
            { trend: 'Interconnexions sant√©', description: 'R√©seaux r√©gionaux √©tendus', impact: 'Effet domino inter-√©tablissements', examples: ['GRADeS', 'R√©seaux imagerie'] }
          ],
          intelligence: [
            { source: 'ANSSI', reliability: 'A', confidence: 'high', information: '60% incidents supply chain visent secteur critique', relevance: 5 },
            { source: 'CERT-EU', reliability: 'A', confidence: 'high', information: 'Attaques √©diteurs logiciels +200% en 2024', relevance: 5 },
            { source: 'ENISA', reliability: 'B', confidence: 'medium', information: 'D√©pendances cloud cr√©ent vuln√©rabilit√©s syst√©miques', relevance: 4 }
          ]
        }
      },
      questions: [
        {
          id: 'q1_critical_suppliers',
          question: 'Identifiez les 5 fournisseurs critiques pr√©sentant le plus haut risque supply chain :',
          type: 'multiple_select',
          options: [
            '√âditeur SIH (fournisseur unique, 3000 utilisateurs, maintenance 24h/24)',
            'Microsoft Cloud (Office 365, Teams, 3500 utilisateurs)',
            'Fournisseur PACS (imagerie, 500 utilisateurs, donn√©es critiques)',
            'Op√©rateur t√©l√©com principal (connectivit√© inter-sites)',
            'Laboratoires externes (analyses urgentes, partenariat critique)',
            'Prestataires maintenance biom√©dicale (√©quipements vitaux)',
            'Fournisseur badges (contr√¥le acc√®s, 3500 badges)',
            'Prestataires nettoyage (acc√®s locaux, surveillance limit√©e)',
            'Constructeur serveurs (infrastructure, support standard)',
            '√âditeur antivirus (s√©curit√©, mise √† jour automatique)'
          ],
          correctAnswer: [
            '√âditeur SIH (fournisseur unique, 3000 utilisateurs, maintenance 24h/24)',
            'Op√©rateur t√©l√©com principal (connectivit√© inter-sites)',
            'Laboratoires externes (analyses urgentes, partenariat critique)',
            'Fournisseur PACS (imagerie, 500 utilisateurs, donn√©es critiques)',
            'Prestataires maintenance biom√©dicale (√©quipements vitaux)'
          ],
          explanation: `**Top 5 fournisseurs critiques supply chain :**

ü•á **√âditeur SIH** : Fournisseur unique = SPOF critique
ü•à **Op√©rateur t√©l√©com** : Connectivit√© vitale inter-sites
ü•â **Laboratoires externes** : Analyses urgences vitales
üèÖ **Fournisseur PACS** : Imagerie diagnostique critique
üèÖ **Maintenance biom√©dicale** : √âquipements patients vitaux

**Crit√®res de criticit√© :**
- Impact direct sur soins patients
- Absence d'alternative (SPOF)
- Acc√®s privil√©gi√© syst√®mes/donn√©es
- D√©lai de remplacement √©lev√©`,
          points: 35,
          hints: ['Focalisez sur l\'impact direct soins patients', 'Identifiez les fournisseurs uniques (SPOF)'],
          expertTips: ['Un fournisseur unique = risque critique automatique', 'L\'acc√®s privil√©gi√© amplifie le risque']
        },
        {
          id: 'q2_propagation_scenarios',
          question: 'Analysez les sc√©narios de propagation en cascade selon leur probabilit√© et impact :',
          type: 'scenario_analysis',
          options: [
            'Compromission √©diteur SIH ‚Üí Backdoor ‚Üí 50+ h√¥pitaux clients',
            'Panne Microsoft 365 ‚Üí Perte communication ‚Üí Coordination d√©grad√©e',
            'Malware laboratoire externe ‚Üí Propagation r√©seau ‚Üí Contamination CHU',
            'Cyberattaque op√©rateur t√©l√©com ‚Üí Isolement sites ‚Üí Perte coordination',
            'D√©faillance prestataire maintenance ‚Üí Panne √©quipements ‚Üí Arr√™t soins',
            'Compromission fournisseur PACS ‚Üí Acc√®s images ‚Üí Chantage patients'
          ],
          correctAnswer: {
            'CRITIQUE (P√óI ‚â• 12)': [
              'Compromission √©diteur SIH ‚Üí Backdoor ‚Üí 50+ h√¥pitaux clients',
              'Cyberattaque op√©rateur t√©l√©com ‚Üí Isolement sites ‚Üí Perte coordination'
            ],
            '√âLEV√â (P√óI = 8-11)': [
              'Malware laboratoire externe ‚Üí Propagation r√©seau ‚Üí Contamination CHU',
              'D√©faillance prestataire maintenance ‚Üí Panne √©quipements ‚Üí Arr√™t soins'
            ],
            'MOD√âR√â (P√óI = 4-7)': [
              'Panne Microsoft 365 ‚Üí Perte communication ‚Üí Coordination d√©grad√©e',
              'Compromission fournisseur PACS ‚Üí Acc√®s images ‚Üí Chantage patients'
            ]
          },
          explanation: `**Analyse sc√©narios propagation :**

üî¥ **CRITIQUE** : Impact syst√©mique + Probabilit√© √©lev√©e
- **SIH compromis** : 1 fournisseur ‚Üí 50+ clients (effet multiplicateur)
- **T√©l√©com attaqu√©** : Isolement sites ‚Üí paralysie coordination

üü† **√âLEV√â** : Impact direct soins + Probabilit√© mod√©r√©e
- **Laboratoire contamin√©** : Propagation r√©seau √©tablie
- **Maintenance d√©faillante** : √âquipements vitaux en panne

üü° **MOD√âR√â** : Impact indirect + Solutions contournement
- **Microsoft 365** : Communication d√©grad√©e mais alternatives
- **PACS compromis** : Impact localis√© imagerie`,
          points: 35,
          expertTips: ['Les effets multiplicateurs cr√©ent les risques critiques', 'Analysez les d√©pendances en cascade']
        }
      ],
      context: {
        hospitalType: 'CHU M√©tropolitain',
        bedCount: 1200,
        sites: 3,
        employees: 3500,
        budget: '450M‚Ç¨/an',
        specialties: ['Urgences', 'R√©animation', 'Cardiologie', 'Neurochirurgie', 'Oncologie'],
        essentialAssets: [
          { id: 'sih_principal', name: 'SIH Principal', criticality: 'CRITIQUE', attractiveness: 5 },
          { id: 'connectivite_sites', name: 'Connectivit√© inter-sites', criticality: 'CRITIQUE', attractiveness: 4 }
        ],
        securityMaturity: 3,
        regulatoryRequirements: ['HDS', 'RGPD', 'HAS', 'ANSSI'],
        operationalConstraints: [
          { type: 'Fournisseur unique', description: 'SIH sans alternative', impact: 'D√©pendance critique', mitigation: 'Contrat renforc√©' },
          { type: 'Interconnexions', description: '25 partenaires connect√©s', impact: 'Propagation risques', mitigation: 'Segmentation r√©seau' },
          { type: 'R√©glementaire', description: 'Certification HDS obligatoire', impact: 'Choix fournisseurs limit√©', mitigation: 'Due diligence renforc√©e' }
        ],
        ecosystem: [
          { name: '√âditeur SIH', type: 'Fournisseur unique', criticality: 'CRITIQUE', services: ['SIH', 'Support'], riskLevel: 10 },
          { name: 'Op√©rateur t√©l√©com', type: 'Infrastructure', criticality: 'CRITIQUE', services: ['Connectivit√©'], riskLevel: 9 },
          { name: 'Laboratoires externes', type: 'Partenaire', criticality: 'CRITIQUE', services: ['Analyses'], riskLevel: 8 },
          { name: 'Microsoft', type: 'Cloud provider', criticality: 'MAJEUR', services: ['Office 365'], riskLevel: 7 }
        ]
      },
      learningObjectives: [
        'Cartographier l\'√©cosyst√®me num√©rique complexe du CHU',
        'Identifier les d√©pendances critiques externes',
        'Analyser les risques de la cha√Æne d\'approvisionnement',
        '√âvaluer les impacts des d√©faillances en cascade'
      ],
      realWorldExample: 'Analyse supply chain post-incident SolarWinds sant√© (2020)',
      anssiCompliance: ['Guide EBIOS RM - Analyse √©cosyst√®me', 'R√©f√©rentiel supply chain security ANSSI']
    };
  }

  // üéØ EXERCICE 4 - THREAT INTELLIGENCE SANT√â (25 MIN, 90 PTS)
  static getExercise4_ThreatIntelligence(): RiskSourceExercise {
    return {
      id: 'exercise_4_threat_intelligence',
      title: 'Threat Intelligence Sant√©',
      description: 'Ma√Ætriser la collecte et analyse de threat intelligence sectorielle',
      type: 'threat_intelligence',
      difficulty: 'advanced',
      duration: 25,
      points: 90,
      category: 'Intelligence des menaces',
      scenario: {
        id: 'chu_threat_intelligence',
        title: 'Veille s√©curit√© CHU - Sources et IOC sp√©cialis√©s sant√©',
        description: 'Structurer la collecte et l\'analyse de threat intelligence pour le secteur sant√©',
        context: `Mission : Mettre en place un syst√®me de threat intelligence adapt√© au CHU.
        Contrainte : Int√©grer sources sp√©cialis√©es sant√© et IOC sectoriels.`,
        constraints: [
          'Sources sp√©cialis√©es sant√© prioritaires',
          'IOC sectoriels valid√©s et pertinents',
          'Corr√©lation avec incidents CHU',
          'Partage collaboratif CERT Sant√©'
        ],
        stakeholders: [
          'RSSI', 'SOC Manager', 'Threat Intelligence Analyst',
          'CERT Sant√©', 'Partenaires CHU', '√âditeurs s√©curit√©'
        ],
        expectedOutcome: 'Syst√®me TI op√©rationnel avec sources et processus',
        threatLandscape: {
          year: '2024',
          sector: 'Sant√©',
          incidents: [
            { date: '2024-Q1', target: 'CHU europ√©ens', type: 'Ransomware', impact: 'LockBit 3.0 campagne', source: 'CERT-EU' },
            { date: '2024-Q2', target: 'Recherche m√©dicale', type: 'Espionnage', impact: 'APT40 campagne COVID', source: 'ANSSI' },
            { date: '2024-Q3', target: 'Supply chain sant√©', type: 'Compromission', impact: '√âditeur SIH backdoor', source: 'HC3' }
          ],
          trends: [
            { trend: 'IOC sp√©cialis√©s', description: 'Indicateurs ciblant sp√©cifiquement sant√©', impact: 'D√©tection am√©lior√©e', examples: ['Hash malware sant√©', 'Domaines C2 sectoriels'] },
            { trend: 'Partage collaboratif', description: '√âchange TI entre √©tablissements', impact: 'D√©fense collective', examples: ['CERT Sant√©', 'R√©seaux r√©gionaux'] },
            { trend: 'Automatisation TI', description: 'Int√©gration SIEM/SOAR', impact: 'R√©ponse acc√©l√©r√©e', examples: ['MISP', 'STIX/TAXII'] }
          ],
          intelligence: [
            { source: 'CERT Sant√©', reliability: 'A', confidence: 'high', information: 'IOC LockBit 3.0 sp√©cialis√©s sant√© disponibles', relevance: 5 },
            { source: 'ANSSI', reliability: 'A', confidence: 'high', information: 'Campagne APT40 recherche m√©dicale confirm√©e', relevance: 4 },
            { source: 'HC3 US', reliability: 'B', confidence: 'medium', information: 'Backdoor √©diteur SIH d√©tect√© 15 √©tablissements', relevance: 5 }
          ]
        }
      },
      questions: [
        {
          id: 'q1_ti_sources_prioritization',
          question: 'Priorisez ces 8 sources de threat intelligence selon leur pertinence pour le CHU :',
          type: 'ranking',
          options: [
            'CERT Sant√© (France) - Sp√©cialis√© secteur, IOC valid√©s, partage collaboratif',
            'ANSSI - Autorit√© nationale, incidents critiques, recommandations officielles',
            'HC3 (US Healthcare) - Expertise sant√© mondiale, incidents internationaux',
            'ENISA - Union europ√©enne, tendances sectorielles, bonnes pratiques',
            'CrowdStrike - Commercial, threat hunting, intelligence premium',
            'MITRE ATT&CK - Framework public, techniques document√©es, mapping',
            'VirusTotal - IOC communautaires, hash malware, domaines suspects',
            'Forums dark web - Intelligence brute, discussions criminelles, prix donn√©es'
          ],
          correctAnswer: [
            'CERT Sant√© (France) - Sp√©cialis√© secteur, IOC valid√©s, partage collaboratif',
            'ANSSI - Autorit√© nationale, incidents critiques, recommandations officielles',
            'HC3 (US Healthcare) - Expertise sant√© mondiale, incidents internationaux',
            'ENISA - Union europ√©enne, tendances sectorielles, bonnes pratiques',
            'MITRE ATT&CK - Framework public, techniques document√©es, mapping',
            'CrowdStrike - Commercial, threat hunting, intelligence premium',
            'VirusTotal - IOC communautaires, hash malware, domaines suspects',
            'Forums dark web - Intelligence brute, discussions criminelles, prix donn√©es'
          ],
          explanation: `**Priorisation sources TI pour CHU :**

ü•á **CERT Sant√©** : Sp√©cialisation sectorielle maximale
ü•à **ANSSI** : Autorit√© nationale de r√©f√©rence
ü•â **HC3** : Expertise sant√© internationale reconnue
üèÖ **ENISA** : Perspective europ√©enne sectorielle
üèÖ **MITRE ATT&CK** : Framework technique standard
üèÖ **CrowdStrike** : Intelligence commerciale premium
üèÖ **VirusTotal** : IOC communautaires massifs
üèÖ **Dark web** : Intelligence brute (expertise requise)

**Crit√®res :** Sp√©cialisation sant√© > Fiabilit√© > Pertinence g√©ographique`,
          points: 25,
          hints: ['Priorisez la sp√©cialisation sant√©', 'La fiabilit√© prime sur la quantit√©'],
          expertTips: ['CERT Sant√© est la r√©f√©rence sectorielle fran√ßaise', 'Combinez sources officielles et commerciales']
        },
        {
          id: 'q2_ioc_analysis',
          question: 'Analysez ces 6 IOC selon leur pertinence pour la d√©tection CHU :',
          type: 'multiple_select',
          options: [
            'Hash SHA256: a1b2c3... (LockBit 3.0 variant sant√©, d√©tect√© 5 CHU)',
            'Domaine C2: health-update[.]com (APT40 campagne recherche m√©dicale)',
            'IP: 192.168.1.100 (Adresse interne g√©n√©rique, non sp√©cifique)',
            'Registry: HKLM\\Software\\HealthMalware (Persistance malware sant√©)',
            'Process: svchost.exe (Processus Windows l√©gitime, faux positif probable)',
            'Network: TCP/443 vers health-data[.]ru (Exfiltration donn√©es patients)'
          ],
          correctAnswer: [
            'Hash SHA256: a1b2c3... (LockBit 3.0 variant sant√©, d√©tect√© 5 CHU)',
            'Domaine C2: health-update[.]com (APT40 campagne recherche m√©dicale)',
            'Registry: HKLM\\Software\\HealthMalware (Persistance malware sant√©)',
            'Network: TCP/443 vers health-data[.]ru (Exfiltration donn√©es patients)'
          ],
          explanation: `**Analyse IOC pertinents CHU :**

‚úÖ **PERTINENTS :**
- **Hash LockBit sant√©** : Sp√©cifique secteur + confirm√© 5 CHU
- **Domaine C2 APT40** : Campagne cibl√©e recherche m√©dicale
- **Registry malware** : Indicateur technique sp√©cialis√©
- **Exfiltration r√©seau** : Pattern donn√©es patients

‚ùå **NON PERTINENTS :**
- **IP interne** : G√©n√©rique, non sp√©cifique menace
- **svchost.exe** : Processus l√©gitime, faux positif

**Crit√®res qualit√© IOC :** Sp√©cificit√© + Contexte + Validation terrain`,
          points: 25,
          expertTips: ['Les IOC sp√©cialis√©s sant√© sont plus fiables', 'Validez avec incidents terrain confirm√©s']
        }
      ],
      context: {
        hospitalType: 'CHU M√©tropolitain',
        bedCount: 1200,
        sites: 3,
        employees: 3500,
        budget: '450M‚Ç¨/an',
        specialties: ['Urgences', 'R√©animation', 'Cardiologie', 'Neurochirurgie', 'Oncologie', 'Recherche'],
        essentialAssets: [
          { id: 'sih_principal', name: 'SIH Principal', criticality: 'CRITIQUE', attractiveness: 5 },
          { id: 'recherche_clinique', name: 'Recherche clinique', criticality: 'MAJEUR', attractiveness: 4 }
        ],
        securityMaturity: 3,
        regulatoryRequirements: ['HDS', 'RGPD', 'HAS', 'ANSSI'],
        operationalConstraints: [
          { type: 'Sp√©cialisation', description: 'Menaces sant√© sp√©cifiques', impact: 'IOC g√©n√©riques inefficaces', mitigation: 'Sources sp√©cialis√©es' },
          { type: 'Partage', description: 'Collaboration CERT Sant√©', impact: 'Intelligence collective', mitigation: 'Plateforme MISP' },
          { type: 'Automatisation', description: 'Int√©gration SIEM', impact: 'R√©ponse temps r√©el', mitigation: 'STIX/TAXII' }
        ],
        ecosystem: [
          { name: 'CERT Sant√©', type: 'Partenaire TI', criticality: 'CRITIQUE', services: ['IOC', 'Alertes'], riskLevel: 2 },
          { name: 'ANSSI', type: 'Autorit√©', criticality: 'MAJEUR', services: ['Bulletins', 'Recommandations'], riskLevel: 1 },
          { name: '√âditeurs s√©curit√©', type: 'Fournisseur', criticality: 'MAJEUR', services: ['Intelligence premium'], riskLevel: 3 }
        ]
      },
      learningObjectives: [
        'Ma√Ætriser la collecte et analyse de threat intelligence sectorielle',
        'Identifier les sources sp√©cialis√©es sant√© prioritaires',
        'Analyser et valider les IOC sectoriels',
        'Structurer le partage collaboratif avec partenaires'
      ],
      realWorldExample: 'Mise en place TI collaborative CERT Sant√© (2023)',
      anssiCompliance: ['Guide threat intelligence ANSSI', 'R√©f√©rentiel partage IOC']
    };
  }

  // üèõÔ∏è EXERCICE 5 - SIMULATION COMIT√â THREAT INTELLIGENCE (25 MIN, 120 PTS)
  static getExercise5_GovernanceSimulation(): RiskSourceExercise {
    return {
      id: 'exercise_5_governance_simulation',
      title: 'Simulation Comit√© Threat Intelligence',
      description: 'Ma√Ætriser la pr√©sentation et validation des sources de risque en comit√©',
      type: 'governance_simulation',
      difficulty: 'expert',
      duration: 25,
      points: 120,
      category: 'Gouvernance TI',
      scenario: {
        id: 'chu_ti_committee',
        title: 'Comit√© mensuel threat intelligence CHU avec 6 participants',
        description: 'Pr√©senter l\'analyse des sources de risque et g√©rer une alerte critique en temps r√©el',
        context: `Situation : Comit√© mensuel TI + Alerte critique en cours de r√©union.
        Enjeu : Pr√©senter l'analyse sources + G√©rer crise en temps r√©el.`,
        constraints: [
          'Comit√© multidisciplinaire avec niveaux techniques vari√©s',
          'Alerte critique LockBit 4.0 pendant la r√©union',
          'D√©cisions rapides requises sous pression',
          'Communication adapt√©e par interlocuteur'
        ],
        stakeholders: [
          'RSSI (pilotage threat intelligence)',
          'DSI (impact technique)',
          'Directeur M√©dical (impact op√©rationnel)',
          'Directeur Qualit√© (conformit√© r√©glementaire)',
          'Chef projet s√©curit√© (mise en ≈ìuvre)',
          'Repr√©sentant CERT Sant√© (coordination externe)'
        ],
        expectedOutcome: 'D√©cisions valid√©es + Plan de r√©ponse activ√©',
        threatLandscape: {
          year: '2024',
          sector: 'Sant√©',
          incidents: [
            { date: '2024-12-15 14:30', target: 'CHU europ√©ens', type: 'Ransomware', impact: 'LockBit 4.0 nouvelle campagne', source: 'CERT-EU FLASH' },
            { date: '2024-12-15 14:45', target: 'CHU Bordeaux', type: 'Compromission', impact: 'SIH chiffr√©, urgences ferm√©es', source: 'CERT Sant√© URGENT' },
            { date: '2024-12-15 15:00', target: 'Votre CHU', type: 'Tentative', impact: 'IOC d√©tect√©s, attaque en cours', source: 'SOC interne' }
          ],
          trends: [
            { trend: 'LockBit 4.0', description: 'Nouvelle version plus agressive', impact: 'Chiffrement + destruction sauvegardes', examples: ['Techniques anti-forensic', 'Propagation acc√©l√©r√©e'] },
            { trend: 'Ciblage coordonn√©', description: 'Attaques simultan√©es multiples CHU', impact: 'Saturation capacit√©s r√©ponse', examples: ['5 CHU touch√©s en 2h', 'CERT Sant√© d√©bord√©'] },
            { trend: 'Exploitation 0-day', description: 'Vuln√©rabilit√© SIH inconnue', impact: 'D√©fenses contourn√©es', examples: ['Patch non disponible', 'Mitigation complexe'] }
          ],
          intelligence: [
            { source: 'CERT Sant√©', reliability: 'A', confidence: 'high', information: 'LockBit 4.0 campagne active, 5 CHU touch√©s', relevance: 5 },
            { source: 'SOC interne', reliability: 'A', confidence: 'high', information: 'IOC LockBit d√©tect√©s sur r√©seau CHU', relevance: 5 },
            { source: 'CERT-EU', reliability: 'A', confidence: 'medium', information: 'Vuln√©rabilit√© 0-day SIH exploit√©e', relevance: 5 }
          ]
        }
      },
      questions: [
        {
          id: 'q1_crisis_briefing',
          question: 'Structurez votre briefing de crise (5 minutes) pour le comit√© :',
          type: 'scenario_analysis',
          correctAnswer: {
            'Situation (1 min)': 'LockBit 4.0 campagne active, 5 CHU touch√©s, IOC d√©tect√©s chez nous',
            'Impact (1 min)': 'Risque paralysie SIH, fermeture urgences, vies en jeu',
            'Actions (2 min)': 'Isolement pr√©ventif, activation PCA, coordination CERT',
            'D√©cisions (1 min)': 'Validation mesures d\'urgence, communication de crise'
          },
          explanation: `**Structure briefing de crise optimale :**

‚è±Ô∏è **1 min - SITUATION** : Faits essentiels sans d√©tails techniques
‚ö†Ô∏è **1 min - IMPACT** : Cons√©quences m√©tier concr√®tes
üõ°Ô∏è **2 min - ACTIONS** : Mesures prises et en cours
‚úÖ **1 min - D√âCISIONS** : Validations requises du comit√©

**Cl√© du succ√®s :** Clart√© + Concision + Orientation action`,
          points: 35,
          hints: ['Restez factuel et concis', 'Focalisez sur les d√©cisions √† prendre'],
          expertTips: ['En crise, la clart√© prime sur l\'exhaustivit√©', 'Pr√©parez les d√©cisions, pas les explications']
        },
        {
          id: 'q2_stakeholder_management',
          question: 'Le Directeur M√©dical interrompt : "Faut-il fermer les urgences maintenant ?" Comment r√©pondez-vous ?',
          type: 'scenario_analysis',
          options: [
            'R√©ponse technique : "Les IOC ne confirment pas encore une compromission"',
            'R√©ponse prudente : "Par pr√©caution, je recommande la fermeture imm√©diate"',
            'R√©ponse √©quilibr√©e : "Isolement pr√©ventif en cours, d√©cision dans 30 minutes"',
            'R√©ponse d√©l√©gu√©e : "C\'est votre d√©cision m√©dicale, nous vous assistons"',
            'R√©ponse proc√©durale : "Le plan de crise pr√©voit cette situation, appliquons-le"'
          ],
          correctAnswer: ['R√©ponse √©quilibr√©e : "Isolement pr√©ventif en cours, d√©cision dans 30 minutes"'],
          explanation: `**Gestion optimale de la pression d√©cisionnelle :**

‚úÖ **R√©ponse √©quilibr√©e** : Mesures imm√©diates + d√©lai raisonnable
- Montre l'action en cours (isolement)
- Donne un d√©lai pr√©cis (30 min)
- √âvite d√©cision pr√©cipit√©e sous stress

‚ùå **Autres approches :**
- **Technique** : Trop complexe en crise
- **Prudente** : Peut √™tre excessive
- **D√©l√©gu√©e** : √âvite la responsabilit√©
- **Proc√©durale** : Rigide, non adapt√©e

**Principe :** Action imm√©diate + √âvaluation rapide + D√©cision √©clair√©e`,
          points: 40,
          expertTips: ['En crise, √©quilibrez prudence et continuit√©', 'Donnez des d√©lais pr√©cis pour rassurer']
        }
      ],
      context: {
        hospitalType: 'CHU M√©tropolitain',
        bedCount: 1200,
        sites: 3,
        employees: 3500,
        budget: '450M‚Ç¨/an',
        specialties: ['Urgences', 'R√©animation', 'Cardiologie', 'Neurochirurgie', 'Oncologie'],
        essentialAssets: [
          { id: 'urgences_vitales', name: 'Urgences vitales', criticality: 'CRITIQUE', attractiveness: 5 },
          { id: 'sih_principal', name: 'SIH Principal', criticality: 'CRITIQUE', attractiveness: 5 }
        ],
        securityMaturity: 3,
        regulatoryRequirements: ['HDS', 'RGPD', 'HAS', 'ANSSI'],
        operationalConstraints: [
          { type: 'Crise temps r√©el', description: 'D√©cisions sous pression', impact: 'Stress d√©cisionnel', mitigation: 'Proc√©dures claires' },
          { type: 'Multidisciplinaire', description: 'Niveaux techniques vari√©s', impact: 'Communication complexe', mitigation: 'Adaptation discours' },
          { type: 'Vies en jeu', description: 'Enjeux vitaux', impact: 'Pression maximale', mitigation: 'Sang-froid professionnel' }
        ],
        ecosystem: [
          { name: 'CERT Sant√©', type: 'Partenaire crise', criticality: 'CRITIQUE', services: ['Coordination', 'Intelligence'], riskLevel: 2 },
          { name: 'Comit√© direction', type: 'Gouvernance', criticality: 'CRITIQUE', services: ['D√©cisions strat√©giques'], riskLevel: 1 }
        ]
      },
      learningObjectives: [
        'Ma√Ætriser la pr√©sentation en comit√© multidisciplinaire',
        'G√©rer une crise de s√©curit√© en temps r√©el',
        'Adapter la communication par type d\'interlocuteur',
        'Prendre des d√©cisions rapides sous pression'
      ],
      realWorldExample: 'Gestion crise LockBit CHU Bordeaux (2024)',
      anssiCompliance: ['Guide gestion de crise ANSSI', 'Proc√©dures d\'urgence secteur sant√©']
    };
  }

  // üéØ M√âTHODES UTILITAIRES
  static getAllExercises(): RiskSourceExercise[] {
    return [
      this.getExercise1_ExternalSources(),
      this.getExercise2_InternalThreats(),
      this.getExercise3_SupplyChain(),
      this.getExercise4_ThreatIntelligence(),
      this.getExercise5_GovernanceSimulation()
    ];
  }

  static getExerciseById(exerciseId: string): RiskSourceExercise | undefined {
    return this.getAllExercises().find(ex => ex.id === exerciseId);
  }

  static getExercisesByDifficulty(difficulty: 'intermediate' | 'advanced' | 'expert'): RiskSourceExercise[] {
    return this.getAllExercises().filter(ex => ex.difficulty === difficulty);
  }

  static getTotalDuration(): number {
    return this.getAllExercises().reduce((total, ex) => total + ex.duration, 0);
  }

  static getTotalPoints(): number {
    return this.getAllExercises().reduce((total, ex) => total + ex.points, 0);
  }
}
