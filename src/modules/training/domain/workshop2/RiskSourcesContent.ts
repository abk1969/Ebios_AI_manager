/**
 * üéØ CONTENU D√âTAILL√â ATELIER 2 - SOURCES DE RISQUE
 * Contenu sp√©cialis√© pour l'identification et l'analyse des sources de risque CHU
 */

// üéØ TYPES POUR LE CONTENU ATELIER 2
export interface RiskSourceStep {
  id: string;
  title: string;
  description: string;
  type: 'theory' | 'exercise' | 'validation';
  duration: number;
  content: string;
  learningObjectives: string[];
  keyPoints: string[];
  examples: ThreatExample[];
  threatIntelligence: ThreatIntelligenceData[];
  exercises?: RiskSourceExercise[];
  completed: boolean;
}

export interface ThreatExample {
  title: string;
  description: string;
  context: string;
  outcome: string;
  lessons: string[];
  threatActors: string[];
  techniques: string[];
  impact: string;
}

export interface ThreatIntelligenceData {
  source: string;
  reliability: 'A' | 'B' | 'C' | 'D';
  confidence: 'high' | 'medium' | 'low';
  information: string;
  relevance: number; // 1-5
  date: string;
  ioc: string[];
}

export interface RiskSourceExercise {
  id: string;
  question: string;
  type: 'external_identification' | 'internal_analysis' | 'supply_chain_assessment' | 'threat_intelligence';
  options?: string[];
  correctAnswer?: any;
  explanation: string;
  points: number;
}

/**
 * üéØ CLASSE PRINCIPALE DU CONTENU ATELIER 2
 */
export class RiskSourcesContent {
  
  // üìã MODULE 2.1 - IDENTIFICATION DES SOURCES EXTERNES (30 MINUTES)
  static getModule2_1_ExternalSources(): RiskSourceStep {
    return {
      id: 'module_2_1_external_sources',
      title: 'Identification des Sources Externes',
      description: 'Ma√Ætriser l\'identification des sources de risque externes sp√©cialis√©es sant√©',
      type: 'theory',
      duration: 30,
      content: `
# üåê IDENTIFICATION DES SOURCES EXTERNES CHU

## üìã OBJECTIFS D'APPRENTISSAGE
- Identifier les sources externes sp√©cifiques au secteur sant√©
- Analyser les motivations des attaquants ciblant les h√¥pitaux
- √âvaluer les capacit√©s techniques et organisationnelles requises
- Prioriser les sources selon la menace pour le CHU

## üîç 1. CYBERCRIMINELS SP√âCIALIS√âS SANT√â

### Groupes ransomware hospitaliers
**ü¶† LockBit 3.0 et successeurs :**
- **Sp√©cialisation** : Infrastructures critiques sant√©
- **Tactiques** : Double extorsion + destruction sauvegardes
- **Ran√ßons** : 1M‚Ç¨-10M‚Ç¨ selon taille √©tablissement
- **Historique** : 40% attaques h√¥pitaux 2024

**ü¶† Conti successeurs (Karakurt, BlackByte) :**
- **Sp√©cialisation** : Expertise secteur sant√© acquise
- **Tactiques** : Reconnaissance longue + mouvement lat√©ral
- **Ran√ßons** : 500k‚Ç¨-5M‚Ç¨ + menace publication
- **Historique** : √âvolution post-d√©mant√®lement Conti

**ü¶† BlackCat/ALPHV :**
- **Sp√©cialisation** : Ransomware-as-a-Service sant√©
- **Tactiques** : Techniques d'√©vasion avanc√©es
- **Ran√ßons** : 2M‚Ç¨-15M‚Ç¨ + leak sites d√©di√©s
- **Historique** : Croissance 300% en 2024

### Trafiquants de donn√©es m√©dicales
**üí∞ March√© noir donn√©es sant√© :**
- **Prix** : 50‚Ç¨-1000‚Ç¨/dossier selon compl√©tude
- **Demande** : Fraude assurance, usurpation identit√©
- **Volume** : 500M+ dossiers √©chang√©s/an
- **Plateformes** : Dark web, forums sp√©cialis√©s

**üí∞ Techniques d'exfiltration :**
- **Acc√®s privil√©gi√©** : Corruption personnel interne
- **Exploitation vuln√©rabilit√©s** : Syst√®mes m√©dicaux non patch√©s
- **Ing√©nierie sociale** : Ciblage personnel soignant
- **Supply chain** : Compromission fournisseurs

## üåç 2. MENACES √âTATIQUES ET G√âOPOLITIQUES

### Espionnage recherche m√©dicale
**üá®üá≥ Chine (APT1, APT40, APT41) :**
- **Cibles** : Recherche vaccins, traitements innovants
- **M√©thodes** : Spear phishing, supply chain attacks
- **Objectifs** : Transfert technologique, avantage √©conomique
- **Exemples** : Vol recherche COVID-19 (2020-2024)

**üá∑üá∫ Russie (APT28, APT29, Sandworm) :**
- **Cibles** : Infrastructures sant√© occidentales
- **M√©thodes** : Malware sophistiqu√©, living off the land
- **Objectifs** : D√©stabilisation, pr√©paration cyberguerre
- **Exemples** : Attaques h√¥pitaux ukrainiens (2022-2024)

**üá∞üáµ Cor√©e du Nord (Lazarus, APT38) :**
- **Cibles** : Laboratoires pharmaceutiques, recherche
- **M√©thodes** : Ransomware, vol cryptomonnaies
- **Objectifs** : Financement programme nucl√©aire
- **Exemples** : WannaCry impact h√¥pitaux (2017)

### D√©stabilisation syst√®mes sant√©
**üéØ Objectifs strat√©giques :**
- **Affaiblissement moral** populations civiles
- **Test r√©silience** infrastructures critiques
- **D√©monstration capacit√©s** cyber offensives
- **Pr√©paration conflits** futurs (cyber warfare)

**üéØ Techniques privil√©gi√©es :**
- **Attaques coordonn√©es** multi-sites simultan√©es
- **Compromission long terme** (APT persistantes)
- **Sabotage √©quipements** m√©dicaux connect√©s
- **D√©sinformation** sant√© publique

## üè≠ 3. MENACES √âCOSYST√àME SANT√â

### Fournisseurs √©quipements biom√©dicaux
**‚öïÔ∏è Vuln√©rabilit√©s mat√©rielles :**
- **Firmware non s√©curis√©** : IoT m√©dical vuln√©rable
- **Protocoles non chiffr√©s** : Communications interceptables
- **Mots de passe par d√©faut** : Acc√®s non autoris√©s
- **Mises √† jour inexistantes** : Vuln√©rabilit√©s persistantes

**‚öïÔ∏è √âquipements √† risque :**
- **Scanners et IRM** : Connect√©s r√©seau, donn√©es sensibles
- **Pompes √† perfusion** : Protocoles non s√©curis√©s
- **Moniteurs patients** : Donn√©es temps r√©el critiques
- **Syst√®mes imagerie** : Stockage local non chiffr√©

### Laboratoires partenaires
**üî¨ Risques d'interconnexion :**
- **√âchange r√©sultats** non s√©curis√©s (HL7, FHIR)
- **Acc√®s bidirectionnel** syst√®mes CHU
- **Partage identifiants** patients communs
- **Synchronisation** bases donn√©es temps r√©el

**üî¨ Vecteurs de compromission :**
- **Attaque laboratoire** ‚Üí propagation CHU
- **Interception communications** (MITM)
- **Corruption donn√©es** √©chang√©es
- **D√©ni de service** analyses urgentes

## üí∞ MOTIVATIONS SP√âCIFIQUES SANT√â

### Motivations financi√®res
**üí∏ Ran√ßonnage hospitalier :**
- **Montants** : 100k‚Ç¨-10M‚Ç¨ selon taille
- **Urgence** : Vies en jeu = pression maximale
- **R√©currence** : H√¥pitaux cibles privil√©gi√©es
- **Impact** : Arr√™t activit√© = 1.2M‚Ç¨/jour

**üí∏ Fraude donn√©es sant√© :**
- **Revente dossiers** : 50-1000‚Ç¨/dossier complet
- **Usurpation identit√©** : Faux remboursements
- **Trafic m√©dicaments** : Prescriptions frauduleuses
- **Chantage patients** : Donn√©es sensibles (VIH, psychiatrie)

### Motivations id√©ologiques
**‚ö° Hacktivisme sant√© :**
- **Protestation syst√®me** sant√© (privatisation)
- **D√©fense droits** patients (confidentialit√©)
- **Lutte laboratoires** pharmaceutiques (prix)
- **Revendications** personnels sant√© (conditions)

**‚ö° Terrorisme cyber :**
- **Impact psychologique** maximal (vies en jeu)
- **D√©stabilisation confiance** syst√®me sant√©
- **Propagande** anti-occidentale (cibles symboliques)
- **D√©monstration capacit√©s** (effet d'annonce)

## üéØ PRIORISATION DES SOURCES

### Matrice de menace CHU
**Score = Motivation √ó Capacit√© √ó Opportunit√©**

**üî¥ PRIORIT√â 1 (Score 18-20) :**
- Cybercriminels sp√©cialis√©s sant√©
- √âtats √©trangers (espionnage/d√©stabilisation)
- Menaces internes privil√©gi√©es

**üü† PRIORIT√â 2 (Score 14-17) :**
- Hacktivistes sectoriels sant√©
- Concurrents √©conomiques
- Prestataires externes critiques

**üü° PRIORIT√â 3 (Score 10-13) :**
- Script kiddies opportunistes
- Curieux et voyeurs
- Erreurs involontaires

### Facteurs d'attractivit√© CHU
**üéØ Facteurs aggravants :**
- **Donn√©es sensibles** : 500k dossiers patients
- **Criticit√© vitale** : Vies en jeu, pression paiement
- **Interconnexions** : 25 partenaires, propagation
- **Visibilit√©** : CHU = cible symbolique
- **Vuln√©rabilit√©s** : Legacy systems, sous-effectifs IT
      `,
      learningObjectives: [
        'Identifier les sources externes sp√©cialis√©es secteur sant√©',
        'Analyser les motivations des attaquants ciblant les h√¥pitaux',
        '√âvaluer les capacit√©s techniques et organisationnelles requises',
        'Prioriser les sources selon la menace pour le CHU'
      ],
      keyPoints: [
        'Les groupes sp√©cialis√©s sant√© sont plus dangereux que les g√©n√©ralistes',
        'Les motivations financi√®res dominent (ran√ßons, donn√©es)',
        'Les √âtats ciblent la recherche m√©dicale strat√©gique',
        'L\'√©cosyst√®me sant√© multiplie les vecteurs d\'attaque'
      ],
      examples: [
        {
          title: 'LockBit 3.0 - Campagne CHU europ√©ens Q1 2024',
          description: 'Attaques coordonn√©es contre 15 CHU en 48h',
          context: 'Exploitation vuln√©rabilit√© 0-day SIH + techniques d\'√©vasion',
          outcome: '5 CHU paralys√©s, 2 semaines r√©cup√©ration, 50M‚Ç¨ dommages',
          lessons: [
            'Sp√©cialisation sectorielle = efficacit√© accrue',
            'Coordination temporelle = saturation d√©fenses',
            'Double extorsion = pression maximale'
          ],
          threatActors: ['LockBit 3.0', 'Affili√©s sp√©cialis√©s sant√©'],
          techniques: ['T1566 Phishing', 'T1055 Process Injection', 'T1486 Data Encrypted'],
          impact: 'CRITIQUE - Vies en jeu, paralysie compl√®te'
        },
        {
          title: 'APT40 - Espionnage recherche COVID-19 (2020-2024)',
          description: 'Campagne persistante contre laboratoires recherche',
          context: 'Ciblage recherche vaccins et traitements innovants',
          outcome: 'Vol propri√©t√© intellectuelle, avantage concurrentiel Chine',
          lessons: [
            'Persistance long terme (4 ans) difficile √† d√©tecter',
            'Recherche m√©dicale = cible g√©opolitique',
            'Techniques APT sophistiqu√©es vs d√©fenses sant√©'
          ],
          threatActors: ['APT40', 'MSS chinois'],
          techniques: ['T1566 Spear Phishing', 'T1078 Valid Accounts', 'T1041 Exfiltration'],
          impact: 'MAJEUR - Perte avantage concurrentiel'
        }
      ],
      threatIntelligence: [
        {
          source: 'CERT Sant√©',
          reliability: 'A',
          confidence: 'high',
          information: '70% h√¥pitaux fran√ßais cibl√©s par ransomware en 2024',
          relevance: 5,
          date: '2024-12-01',
          ioc: ['lockbit3.onion', 'SHA256:a1b2c3d4...']
        },
        {
          source: 'ANSSI',
          reliability: 'A',
          confidence: 'high',
          information: 'APT40 campagnes actives contre recherche m√©dicale fran√ßaise',
          relevance: 4,
          date: '2024-11-15',
          ioc: ['health-update.com', 'IP:203.78.45.12']
        },
        {
          source: 'HC3 US',
          reliability: 'B',
          confidence: 'medium',
          information: 'Trafic donn√©es sant√© +300% sur dark web',
          relevance: 5,
          date: '2024-10-30',
          ioc: ['health-market.onion', 'patient-data.ru']
        }
      ],
      exercises: [
        {
          id: 'exercise_external_profiling',
          question: 'Quel groupe cybercriminel pr√©sente la plus haute menace pour le CHU ?',
          type: 'external_identification',
          options: [
            'LockBit 3.0 - Sp√©cialis√© infrastructures critiques',
            'Script kiddies - Attaques opportunistes',
            'APT40 - Espionnage recherche m√©dicale',
            'Hacktivistes - Protestation syst√®me sant√©'
          ],
          correctAnswer: 'LockBit 3.0 - Sp√©cialis√© infrastructures critiques',
          explanation: 'LockBit 3.0 combine sp√©cialisation sant√©, capacit√©s techniques √©lev√©es et motivation financi√®re forte.',
          points: 25
        }
      ],
      completed: false
    };
  }

  // üéØ M√âTHODES UTILITAIRES
  static getAllModules(): RiskSourceStep[] {
    return [
      this.getModule2_1_ExternalSources()
      // Les autres modules seront ajout√©s
    ];
  }

  static getModuleById(moduleId: string): RiskSourceStep | undefined {
    return this.getAllModules().find(module => module.id === moduleId);
  }

  static getTotalDuration(): number {
    return this.getAllModules().reduce((total, module) => total + module.duration, 0);
  }

  static getThreatIntelligenceByRelevance(minRelevance: number = 3): ThreatIntelligenceData[] {
    return this.getAllModules()
      .flatMap(module => module.threatIntelligence)
      .filter(ti => ti.relevance >= minRelevance)
      .sort((a, b) => b.relevance - a.relevance);
  }

  static getExamplesByImpact(impact: string): ThreatExample[] {
    return this.getAllModules()
      .flatMap(module => module.examples)
      .filter(example => example.impact.includes(impact));
  }
}
